<!DOCTYPE html>
<html lang="es-BO">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- FINAL VERSION 2.1 (RELEASE CANDIDATE) -->
    <title>IA: Creatividad Aumentada o Amenazada - v2.1</title>
    
    <meta name="description" content="C√°psula educativa interactiva y mejorada sobre el impacto de la Inteligencia Artificial en la creatividad humana, optimizada con base en feedback de usuarios.">
    <meta name="keywords" content="IA, Inteligencia Artificial, Creatividad, Educaci√≥n, UX, Dise√±o Instruccional, Herramientas Docentes, Creatividad Aumentada">
    <meta name="author" content="Equipo de Desarrollo Educativo v2.1">

    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üéì</text></svg>">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <style>
        :root{--color-primario:#005f73;--color-secundario:#0a9396;--color-fondo:#f0f8ff;--color-superficie:#ffffff;--color-texto:#0d1b2a;--color-texto-claro:#4a4a4a;--color-acento:#ee9b00;--color-exito:#4f7942;--color-error:#9b2226;--color-borde:#dee2e6;--sombra-suave:0 4px 15px rgba(0, 95, 115, 0.1);--radio-borde:12px;--transicion-suave:all 0.3s ease-in-out;--fuente-principal:'Segoe UI', system-ui, -apple-system, sans-serif;--fuente-titulos:'Georgia', serif;}
        *, *::before, *::after{box-sizing:border-box;margin:0;padding:0;}
        html{scroll-behavior:smooth;}
        body{font-family:var(--fuente-principal);background-color:var(--color-fondo);color:var(--color-texto);line-height:1.7;font-size:16px;}
        @media (prefers-reduced-motion: reduce){html,body,*,*::before,*::after{animation-duration:0.01ms !important;animation-iteration-count:1 !important;transition-duration:0.01ms !important;scroll-behavior:auto !important;}}
        :focus-visible{outline:3px solid var(--color-acento);outline-offset:3px;box-shadow:0 0 0 5px rgba(238,155,0,0.3);border-radius:4px;}
        h1,h2,h3,h4{font-family:var(--fuente-titulos);color:var(--color-primario);margin-bottom:1rem;text-align:center;}
        h3{margin-top:2.5rem;}
        p,li{margin-bottom:1rem;text-align:justify;}
        ul,ol{padding-left:2rem;}
        a{color:var(--color-secundario);text-decoration:none;transition:var(--transicion-suave);}
        a:hover{text-decoration:underline;color:var(--color-acento);}
        main{max-width:900px;margin:2rem auto;padding:1rem;}
        section{display:none;padding:2.5rem;margin-bottom:2rem;background-color:var(--color-superficie);border-radius:var(--radio-borde);box-shadow:var(--sombra-suave);animation:fadeIn 0.8s ease-in-out;border:1px solid var(--color-borde);}
        @keyframes fadeIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
        .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:12px 25px;border:none;border-radius:8px;background-color:var(--color-secundario);color:white;font-weight:bold;font-size:1rem;cursor:pointer;text-align:center;transition:var(--transicion-suave);box-shadow:0 2px 5px rgba(0,0,0,0.1);}
        .btn svg{width:20px;height:20px;}
        .btn:hover:not(:disabled){background-color:var(--color-primario);transform:translateY(-2px);box-shadow:0 4px 10px rgba(0,0,0,0.15);}
        .btn:disabled{background-color:#a0a0a0;cursor:not-allowed;opacity:0.7;}
        .btn-secundario{background-color:transparent;color:var(--color-secundario);border:2px solid var(--color-secundario);}
        .btn-secundario:hover:not(:disabled){background-color:var(--color-secundario);color:white;}
        .input-group{margin-bottom:1.5rem;width:100%;max-width:450px;margin-left:auto;margin-right:auto;}
        .input-group label{display:block;margin-bottom:0.5rem;font-weight:bold;text-align:left;}
        .input-group input,.input-group textarea{width:100%;padding:12px;border-radius:8px;border:1px solid var(--color-borde);transition:var(--transicion-suave);font-family:var(--fuente-principal);}
        .iframe-container{position:relative;width:100%;padding-top:56.25%;overflow:hidden;border-radius:var(--radio-borde);box-shadow:var(--sombra-suave);background:#e9ecef;}
        .iframe-container::before{content:'';position:absolute;top:50%;left:50%;width:40px;height:40px;margin-top:-20px;margin-left:-20px;border-radius:50%;border:4px solid rgba(0,95,115,0.2);border-top-color:var(--color-primario);animation:spin 1s linear infinite;}
        @keyframes spin{to{transform:rotate(360deg);}}
        .iframe-container iframe{position:absolute;top:0;left:0;width:100%;height:100%;border:0;opacity:0;transition:opacity 0.5s;}
        .iframe-container.loaded iframe{opacity:1;}
        .iframe-container.loaded::before{display:none;}
        details{border:1px solid #dee2e6;border-radius:8px;margin-bottom:1rem;}
        summary{cursor:pointer;padding:1rem;font-weight:bold;font-family:var(--fuente-titulos);color:var(--color-primario);list-style:none;display:flex;justify-content:space-between;align-items:center;}
        summary::-webkit-details-marker{display:none;}
        summary::after{content:'‚ñº';font-size:0.8em;transition:transform 0.3s;}
        details[open] summary{border-bottom:1px solid #dee2e6;}
        details[open] summary::after{transform:rotate(180deg);}
        .accordion-content{padding:1rem; animation:fadeIn 0.4s ease-out;}
        #guest-access-btn{display:block;margin-top:1.5rem;text-decoration:underline;color:var(--color-texto-claro);cursor:pointer; background:none; border:none; font-family: inherit; font-size: inherit;}
        #progress-container{position:fixed;top:0;left:0;width:100%;height:8px;background-color:#e0e0e0;z-index:1000;}
        #progress-bar{height:100%;width:0;background-color:var(--color-secundario);transition:width 0.4s ease;}
        .toolkit-list{list-style:none;padding:0;}
        .toolkit-list li{background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%234f7942' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='20 6 9 17 4 12'%3E%3C/polyline%3E%3C/svg%3E") no-repeat left center; background-size: 20px; padding-left: 30px;}
        .navigation-buttons{margin-top: 2rem;display: flex;justify-content: space-between;align-items: center;gap: 1rem;flex-wrap: wrap;}
        #video-quiz-modal,#definicion-modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);backdrop-filter:blur(5px);z-index:2000;display:none;justify-content:center;align-items:center;padding:20px;}
        .video-quiz-contenido,#definicion-contenido{background:var(--color-superficie);padding:2rem;border-radius:var(--radio-borde);max-width:600px;width:100%;text-align:center;animation:fadeIn 0.3s;}
        #definicion-contenido{position:relative;}
        #cerrar-definicion{position:absolute;top:15px;right:15px;background:transparent;border:none;font-size:1.5rem;cursor:pointer;}
        #opciones-test-final .opcion-test:hover {background-color: #e9ecef;}
        #opciones-test-final .opcion-test.seleccionado {border-color: var(--color-secundario); background-color: #e0f7fa;}
        #opciones-test-final .opcion-test.correcto {border-color: var(--color-exito); background-color: #f0fff0;}
        #opciones-test-final .opcion-test.incorrecto {border-color: var(--color-error); background-color: #fff0f0;}
        @media print{.no-print{display:none !important;}}
        @media (max-width: 768px){main{padding:1rem;} #floating-menu{display:none;}}
    </style>
</head>
<body>
    <div id="app-container">
        <header id="progress-container" class="no-print"><div id="progress-bar"></div></header>
        <nav id="floating-menu" class="no-print"></nav>
        <div id="chatbot-button" class="no-print" title="Habla con un experto"><svg viewBox="0 0 24 24" fill="white"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.6 0 1 .4 1 1s-.4 1-1 1C5.4 24 0 18.6 0 12S5.4 0 12 0s12 5.4 12 12c0 5.5-2.8 10.2-6.8 12.8-.6.4-1.2 0-1.2-.7 0-.4 0-1.5 0-2.8 0-.9-.3-1.6-1-2.2-4.1-1.8-6-4.5-6-8.3 0-4.6 3.4-8 7-8s7 3.4 7 8c0 2.2-1.3 4.2-3.3 5.6-1.1.7-1.7 2-1.7 3.3 0 1.5 0 2.9 0 3.3 0 .7-.6 1.1-1.2.7C14.8 22.2 12 17.5 12 12s2.8-10.2 6.8-12.8c.6-.4 1.2 0 1.2.7z"/></svg></div>
        <div id="chatbot-popup" class="no-print"><div id="chatbot-header"><span>Asistente IA</span><button id="cerrar-chatbot">√ó</button></div><iframe loading="lazy" src="https://poe.com/Prof_Luis_Andia" title="Chatbot Asistente"></iframe></div>
        <div id="definicion-modal" role="dialog" aria-modal="true" aria-labelledby="definicion-titulo"><div id="definicion-contenido"><button id="cerrar-definicion" aria-label="Cerrar">√ó</button><h3 id="definicion-titulo"></h3><p id="definicion-texto"></p></div></div>
        <div id="badge-toast" role="alert"><span id="toast-icon"></span><span id="toast-text"></span></div>
        
        <main>
            <!-- El contenido de la secci√≥n activa se inyectar√° aqu√≠ con JavaScript -->
        </main>
        
        <footer class="no-print" style="text-align: center; padding: 2rem; color: #4a4a4a;">
            <p>C√°psula Educativa v2.1. Dise√±ada y desarrollada por Equipo de Desarrollo Creativo.</p>
            <button id="btn-borrar-datos" style="font-size: 0.8em; background:none; border:none; color:var(--color-secundario); cursor:pointer;">Borrar mis datos y reiniciar</button>
        </footer>

        <div id="certificado-html-source" style="display: none; position: absolute; left: -9999px; width:816px; height:1056px;"></div>
    </div>
    
    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- ESTADO Y CONSTANTES ---
        const mainContainer = document.querySelector('main');
        const floatingMenu = document.getElementById('floating-menu');
        const progressBar = document.getElementById('progress-bar');
        
        let estadoUsuario = {};
        let videoQuizState = {};
        let testFinalState = {};
        let lastFocusedElement;
        
        const SECCIONES_TEMPLATES = {
            'seccion-ingreso':`<div class="contenedor-central"><h1>¬°Te damos la bienvenida!</h1><p>Para obtener un certificado y guardar tu progreso, por favor reg√≠strate. O si lo prefieres, explora la c√°psula como invitado.</p><form id="form-ingreso"><div class="input-group"><label for="nombre-completo">Nombre Completo</label><input type="text" id="nombre-completo" required></div><div class="input-group"><label for="email">Correo</label><input type="email" id="email" required></div><button type="submit" class="btn">Registrarse y Empezar</button></form><button id="guest-access-btn"><u>o Explorar como Invitado ‚Üí</u></button></div>`,
            'seccion-portada':`<div class="contenedor-central"><h1>IA: Creatividad Aumentada o Amenaza</h1><p>Explora c√≥mo la Inteligencia Artificial est√° remodelando los l√≠mites de la creatividad humana.</p></div>`,
            'seccion-introduccion': `<h2>Una nueva frontera para el conocimiento</h2><h3>Objetivos de Aprendizaje:</h3><ul><li><strong>Analizar cr√≠ticamente</strong> el doble rol de la IA como herramienta y amenaza para la creatividad.</li><li><strong>Dise√±ar consignas de evaluaci√≥n</strong> que fomenten una sinergia humano-IA.</li><li><strong>Aplicar estrategias pedag√≥gicas</strong> para guiar a los estudiantes en el uso √©tico de la IA.</li></ul><h3>Punto de Partida: Un Dilema muy Real</h3><div style="font-style: italic; border-left: 5px solid var(--color-secundario); padding:1rem; background-color: #f8f9fa; border-radius: var(--radio-borde);"><h4>"El Informe Perfecto"</h4><p>Una docente de Sociolog√≠a recibe un informe impecable de un estudiante de primer a√±o. Sospecha que fue generado por una IA. Su primer impulso es anularlo por fraude. Sin embargo, su colega le hace ver que la consigna que ella dio describ√≠a perfectamente una tarea para una IA. El paradigma ha cambiado. La pregunta ya no es si el alumno hizo trampa, sino... nuestra capacidad para ense√±ar, ¬øest√° aumentada o amenazada?</p></div>`,
            'seccion-activacion':`<h2>Activando Conocimientos Previos</h2><p>Calentemos motores con un juego r√°pido. Encuentra las parejas de conceptos relacionados.</p><div class="iframe-container"><iframe loading="lazy" allowfullscreen src="https://es.educaplay.com/juego/24152723-juego_de_parejas_ia_y_creatividad.html" title="Juego Educaplay"></iframe></div>`,
            'seccion-desarrollo-practico': `<h2>Conectando con la Realidad: Video y Reflexi√≥n</h2><p>Ahora, te invitamos a ver una charla TEDx clave. El video se detendr√° en <strong>4 momentos</strong> para que respondas a una pregunta. No podr√°s continuar sin responder correctamente.</p><div class="iframe-container"><div id="video-principal"></div></div><div id="video-quiz-modal" role="dialog" aria-modal="true"><div class="video-quiz-contenido"><h3 id="pregunta-video-quiz"></h3><div id="opciones-video-quiz"></div><p id="feedback-video-quiz"></p></div></div><h3>Insignia "Inquisidor Digital"</h3><div class="badge-container"><div class="badge" id="badge-explorador"><div id="badge-explorador-icon-placeholder"></div><p>Inquisidor Digital</p></div></div>`,
            'seccion-desarrollo-teorico':`<h2>Profundizando: Teor√≠a y Conceptos Clave</h2><p>Haz clic en cada tema para expandir y leer el contenido detallado.</p>
                <details><summary>Creatividad Aumentada y Metacreatividad</summary><div class="accordion-content"><p>La <strong>Creatividad Aumentada</strong> es el modelo ideal: el humano mantiene la visi√≥n, pero utiliza la IA para expandir sus capacidades. La IA ayuda a superar la <span class="definicion" data-term="Fijaci√≥n Creativa" tabindex="0">Fijaci√≥n Creativa</span> (estancarse en ideas). Esto fomenta la <strong>Metacreatividad</strong>: reflexionar sobre el propio proceso creativo.</p></div></details>
                <details><summary>Implicaciones en la Educaci√≥n</summary><div class="accordion-content"><p>La IA nos obliga a evolucionar. La evaluaci√≥n debe valorar el <strong>proceso</strong>, no solo el producto. Ense√±ar a escribir "prompts" efectivos (<span class="definicion" data-term="Prompt Engineering" tabindex="0">Prompt Engineering</span>) es crucial. Nuestro rol docente se desplaza a <strong>curadores de aprendizaje y mentores √©ticos</strong>.</p></div></details>
                <details><summary>Consideraciones √âticas Cr√≠ticas</summary><div class="accordion-content"><ul><li><strong>Sesgos y Equidad:</strong> Las IAs pueden perpetuar estereotipos.</li><li><strong>Autor√≠a:</strong> ¬øDe qui√©n es una obra co-creada?</li><li><strong>Detecci√≥n vs. Pedagog√≠a:</strong> Las herramientas de detecci√≥n son poco fiables. Un redise√±o pedag√≥gico es superior.</li></ul></div></details>`,
            'seccion-evaluacion-formativa': `<h2>Poniendo a Prueba el Aprendizaje</h2><p>Es momento de una autoevaluaci√≥n l√∫dica para solidificar lo aprendido.</p><div class="iframe-container" style="min-height: 650px; padding-top:0;"><div style="width:100%;height:100%;"><iframe loading="lazy" allowfullscreen src="https://quizizz.com/embed/quiz/6840b44b5c4298f8f5bd9c0b" title="Quizizz"></iframe></div></div><h3>Insignia "Catalizador de Ideas"</h3><div class="badge-container"><div class="badge" id="badge-formativo"><div id="badge-formativo-icon-placeholder"></div><p>Catalizador de Ideas</p></div></div>`,
            'seccion-evaluacion': `<h2>Evaluaci√≥n Final: Demuestra tu Dominio</h2><div style="text-align:center;"><ul><li><strong>Tiempo:</strong> <span id="tiempo-restante">30:00</span></li><li><strong>Aprobaci√≥n:</strong> 70%</li><li><strong>Intentos:</strong> <span id="intentos-restantes">3</span></li></ul></div><div id="test-container" style="margin-top: 2rem;"><div id="pregunta-test-actual"></div><div id="opciones-test-final"></div><button id="btn-evaluar-respuesta" class="btn" style="margin-top:1rem;">Evaluar</button><p id="feedback-test"></p></div><div id="resultado-test" style="display:none; text-align:center;"><h3 id="resultado-titulo"></h3><p id="resultado-texto"></p><button id="btn-reintentar-test" class="btn" style="display:none;">Reintentar</button></div>`,
            'seccion-sintesis': `<h2>S√≠ntesis: Las Grandes Ideas</h2><ol><li><strong>La IA es un Colaborador, no un Or√°culo:</strong> Potencia nuestro proceso, no reemplaza nuestro juicio.</li><li><strong>El Criterio es el Nuevo Superpoder:</strong> La habilidad m√°s valiosa es saber seleccionar, refinar y dar sentido.</li><li><strong>La Educaci√≥n debe Adaptar sus Consignas:</strong> Dise√±ar tareas que exijan pensamiento cr√≠tico.</li></ol>`,
            'seccion-herramientas':`<h2>La Caja de Herramientas del Docente</h2><p>Recursos pr√°cticos para empezar a aplicar estas ideas en tu aula.</p><h3>Checklist de Evaluaci√≥n de Herramientas de IA</h3><ul class="toolkit-list"><li>¬øMejora el aprendizaje o es solo un "efecto wow"?</li><li>¬øEs f√°cil de usar para los estudiantes?</li><li>¬øHe probado la herramienta en busca de sesgos?</li><li>¬øCu√°l es la pol√≠tica de privacidad de datos?</li><li>¬øEs accesible para todos (costo, tecnolog√≠a)?</li></ul><h3>Glosario de Prompts Efectivos</h3><div style="font-style:italic; padding:1rem; background:#f8f9fa; border-radius:8px;"><strong>Para debate:</strong><br><em>"Act√∫a como un soci√≥logo del s. XIX y un activista clim√°tico del s. XXI. Escribe un di√°logo entre ambos sobre el concepto de 'progreso industrial'."</em></div>`,
            'seccion-cierre':`<h2>Cierre: Mirando Hacia Adelante</h2><p>La √∫ltima parada es una oportunidad para la reflexi√≥n personal.</p><form id="form-metacognicion"><div class="input-group"><label>¬øQu√© cambio inmediato planeas implementar?</label><textarea rows="3"></textarea></div><div class="input-group"><label>¬øQu√© idea desafi√≥ m√°s tu pensamiento?</label><textarea rows="3"></textarea></div><div class="input-group"><label>¬øQu√© te gustar√≠a explorar ahora?</label><textarea rows="3"></textarea></div></form><button id="btn-guardar-cierre" class="btn">Guardar y Finalizar</button><div class="contenedor-central" style="margin-top: 2rem;"><h3>√önete a la Conversaci√≥n</h3><p>Comparte tus ideas con otros docentes en nuestra comunidad.</p><a href="https://padlet.com/dashboard" target="_blank" rel="noopener" class="btn">Ir al Muro Comunitario</a></div>`,
            'seccion-final':`<div id="reporte-final-content"><div class="contenedor-central"><h2>¬°Misi√≥n Cumplida, <span class="nombre-usuario">Innovador/a</span>!</h2><p>Aqu√≠ tienes un resumen de tu viaje.</p></div><div class="report-section"><h3>Tu Desempe√±o</h3><p><strong>Puntuaci√≥n Final:</strong> <span id="reporte-puntuacion">N/A</span>%</p></div><div class="report-section"><h3>Insignias</h3><div id="reporte-insignias" class="badge-container"></div></div></div><div id="certificado-wrapper" style="display:none; text-align:center;"><h2>Tu Certificado</h2><p>Felicidades, aqu√≠ tienes tu certificado descargable.</p><div id="certificado-preview" style="border: 1px solid #ccc; margin: 1rem auto; max-width: 800px; aspect-ratio: 8.5/11;"></div><button id="btn-descargar-pdf" class="btn">Descargar PDF</button></div><div class="navigation-buttons" style="justify-content:center;"><button id="btn-ver-certificado" class="btn" disabled>Ver Certificado</button><button id="btn-reiniciar-curso" class="btn btn-secundario">Reiniciar Curso</button></div>`,
        };
        const SECCIONES_DATA = Object.keys(SECCIONES_TEMPLATES).map(key => ({ id: key, nombre: key.split('-')[1].charAt(0).toUpperCase() + key.split('-')[1].slice(1) }));
        const videoQuizData=[{tiempo:59,pregunta:'Seg√∫n el ponente, ¬øqu√© emoci√≥n transmit√≠a el estudiante?',opciones:['Entusiasmo y curiosidad','Pesadumbre y falta de ilusi√≥n','Enojo y frustraci√≥n'],correcta:1},{tiempo:169,pregunta:'Picasso dijo: "Los ordenadores son in√∫tiles, solo pueden darnos respuestas". ¬øQu√© destaca?',opciones:['La inutilidad de la tecnolog√≠a','La importancia de hacerse las preguntas correctas','Que las respuestas son la clave'],correcta:1},{tiempo:359,pregunta:'¬øQu√© consecuencia positiva tuvo la fotograf√≠a para la pintura?',opciones:['La hizo obsoleta','La liber√≥ de la obligaci√≥n de copiar la realidad','Confirm√≥ su superioridad'],correcta:1},{tiempo:588,pregunta:'¬øCu√°l de estas NO es una cualidad humana que la IA no tiene, seg√∫n el ponente?',opciones:['Originalidad','Criterio','Velocidad de procesamiento'],correcta:2}];
        const testFinalData=[{pregunta:'En la historia "El Informe Perfecto", ¬øqu√© concepto introduce el Dr. Mateo?',opciones:['Plagio digital','Creatividad Aumentada','Etnograf√≠a Digital'],correcta:'Etnograf√≠a Digital'},{pregunta:'Seg√∫n el video, ¬øqu√© habilidad se desarrolla con la pr√°ctica y permite evaluar las respuestas de una IA?',opciones:['Inspiraci√≥n','Criterio','Originalidad'],correcta:'Criterio'},{pregunta:'¬øCu√°l es el rol de la IA en la "Creatividad Aumentada"?',opciones:['Reemplazar al humano','Expandir las capacidades humanas','Limitar las opciones'],correcta:'Expandir las capacidades humanas'},{pregunta:'¬øQu√© es el "Prompt Engineering"?',opciones:['La escritura de c√≥digo','La habilidad de escribir instrucciones efectivas para la IA','El dise√±o de hardware para IA'],correcta:'La habilidad de escribir instrucciones efectivas para la IA'},{pregunta:'¬øCu√°l es un riesgo √©tico importante de la IA mencionado en el texto?',opciones:['El alto costo','La perpetuaci√≥n de sesgos','Su lentitud'],correcta:'La perpetuaci√≥n de sesgos'},{pregunta:'¬øCu√°l es la ruta m√°s sabia que deben tomar los educadores frente a la IA?',opciones:['Prohibici√≥n total','Ignorarla','Integraci√≥n cr√≠tica y reflexiva'],correcta:'Integraci√≥n cr√≠tica y reflexiva'}];
        const definiciones={'Fijaci√≥n Creativa':'La tendencia a estancarse en un conjunto limitado y repetitivo de ideas, impidiendo la generaci√≥n de soluciones novedosas.','Prompt Engineering':'El arte y la ciencia de dise√±ar instrucciones (prompts) efectivas para que una IA genere los resultados deseados de manera precisa y √∫til.'};
        const insigniasData={'explorador':{nombre:'Inquisidor Digital',svg:`<svg viewBox="0 0 100 100"><path d="M50 2L95 25V75L50 98L5 75V25L50 2Z" fill="#e0f7fa" stroke="#005f73" stroke-width="3"/><path d="M50 35A15 15 0 1 0 50 65A15 15 0 0 0 50 35z" fill="#0a9396"/><text x="50" y="55" font-family="Arial" font-size="24" fill="white" text-anchor="middle">?</text></svg>`},'teorico':{nombre:'Arquitecto de Conceptos',svg:`<svg viewBox="0 0 100 100"><path d="M50 2L95 25V75L50 98L5 75V25L50 2Z" fill="#e9ecef" stroke="#0d1b2a" stroke-width="3"/><path d="M30 75L50 40L70 75H30Z" stroke="#4a4a4a" stroke-width="4" fill="none"/><circle cx="50" cy="30" r="5" fill="#4a4a4a"/></svg>`},'formativo':{nombre:'Catalizador de Ideas',svg:`<svg viewBox="0 0 100 100"><path d="M50 2L95 25V75L50 98L5 75V25L50 2Z" fill="#fffbe6" stroke="#ee9b00" stroke-width="3"/><path d="M50 30L65 50L50 70L35 50Z" fill="#fefae0" stroke="#ee9b00" stroke-width="3"/><path d="M50 20v6m15 9l-5 3m0 25l5 3m-15 9v-6m-15-9l5-3m0-25l-5-3" stroke="#ee9b00" stroke-width="3" stroke-linecap="round"/></svg>`}};

        function init(){resetState();cargarEstado();mostrarSeccion(estadoUsuario.seccionActual);generarMenuFlotante();inyectarSVGs();document.getElementById('btn-borrar-datos').addEventListener('click',reiniciarCurso);}
        function resetState(){estadoUsuario={nombre:'',email:'',seccionActual:'seccion-ingreso',progreso:0,videoQuizCompletado:false,testFinal:{puntuacion:null,intentos:3,completado:false,aprobado:false,},insignias:[],esInvitado:false,cursoCompletadoUnaVez:false,respuestasMetacognitivas:{}};videoQuizState={player:null,relojVerificador:null,preguntaActual:-1,preguntasMostradas:[]};testFinalState={preguntaActual:0,puntuacion:0,temporizador:null,tiempoRestante:1800};}
        function salvarEstado(){if(estadoUsuario.esInvitado)return;localStorage.setItem('estadoUsuarioIA_v2.1',JSON.stringify(estadoUsuario));}
        function cargarEstado(){const guardado=localStorage.getItem('estadoUsuarioIA_v2.1');if(guardado){estadoUsuario=JSON.parse(guardado);if(typeof estadoUsuario.progreso==='undefined')estadoUsuario.progreso=0;}}
        function reiniciarCurso(){if(confirm('¬øSeguro que quieres borrar todo tu progreso?')){localStorage.removeItem('estadoUsuarioIA_v2.1');resetState();mostrarSeccion('seccion-ingreso');}}
        function mostrarSeccion(idSeccion){estadoUsuario.seccionActual=idSeccion;mainContainer.innerHTML='';const sectionEl=document.createElement('section');sectionEl.id=idSeccion;sectionEl.innerHTML=SECCIONES_TEMPLATES[idSeccion];mainContainer.appendChild(sectionEl);const navButtons=document.createElement('div');navButtons.className='navigation-buttons';if(SECCIONES_DATA.findIndex(s=>s.id===idSeccion)>0){const prevBtn=document.createElement('button');prevBtn.className='btn btn-secundario btn-prev';prevBtn.textContent='Anterior';navButtons.appendChild(prevBtn);}if(SECCIONES_DATA.findIndex(s=>s.id===idSeccion)<SECCIONES_DATA.length-1){const nextBtn=document.createElement('button');nextBtn.className='btn btn-next';nextBtn.textContent='Siguiente';navButtons.appendChild(nextBtn);}sectionEl.appendChild(navButtons);window.scrollTo(0,0);gestionarAccionesAlEntrarSeccion(idSeccion);}
        function gestionarAccionesAlEntrarSeccion(idSeccion){document.querySelectorAll('.btn-prev').forEach(b=>b.addEventListener('click',navegarAnterior));document.querySelectorAll('.btn-next').forEach(b=>b.addEventListener('click',navegarSiguiente));if(idSeccion==='seccion-ingreso'){document.getElementById('form-ingreso').addEventListener('submit',validarFormularioIngreso);document.getElementById('guest-access-btn').addEventListener('click',accederComoInvitado);}if(idSeccion==='seccion-desarrollo-practico'){if(typeof YT!=='undefined'&&YT.Player)crearReproductor();otorgarInsignia('explorador');}if(idSeccion==='seccion-desarrollo-teorico')otorgarInsignia('teorico');if(idSeccion==='seccion-evaluacion-formativa')otorgarInsignia('formativo');if(idSeccion==='seccion-evaluacion'){if(!estadoUsuario.testFinal.aprobado&&estadoUsuario.testFinal.intentos>0)iniciarTestFinal();else finalizarTest();}document.querySelectorAll('.definicion').forEach(el=>el.addEventListener('click',mostrarDefinicion));if(idSeccion==='seccion-cierre')document.getElementById('btn-guardar-cierre').addEventListener('click',guardarReflexiones);if(idSeccion==='seccion-final'){document.getElementById('btn-ver-certificado').addEventListener('click',mostrarCertificado);document.getElementById('btn-reiniciar-curso').addEventListener('click',reiniciarCurso);if(estadoUsuario.testFinal.aprobado)document.getElementById('btn-ver-certificado').disabled=false;}actualizarUI();}
        function actualizarUI(){const i=SECCIONES_DATA.findIndex(s=>s.id===estadoUsuario.seccionActual);if(i===-1)return;progressBar.style.width=`${(i/(SECCIONES_DATA.length-1))*100}%`;document.querySelectorAll('.menu-dot').forEach((d,idx)=>{d.classList.toggle('active',idx===i);d.style.cursor=idx<=estadoUsuario.progreso||estadoUsuario.cursoCompletadoUnaVez?'pointer':'not-allowed';d.style.opacity=idx<=estadoUsuario.progreso||estadoUsuario.cursoCompletadoUnaVez?1:0.5;});document.querySelectorAll('.nombre-usuario').forEach(s=>{s.textContent=estadoUsuario.nombre||'participante';});if(document.querySelector('#seccion-desarrollo-practico .btn-next'))document.querySelector('#seccion-desarrollo-practico .btn-next').disabled=!estadoUsuario.videoQuizCompletado;if(document.querySelector('#seccion-evaluacion .btn-next'))document.querySelector('#seccion-evaluacion .btn-next').disabled=!estadoUsuario.testFinal.completado;if(document.querySelector('#reporte-final-content'))poblarReporteFinal();if(document.querySelectorAll('.badge'))document.querySelectorAll('.badge').forEach(b=>{const id=b.id.split('-')[1];b.style.opacity=estadoUsuario.insignias.includes(id)?1:0.3;});}
        function generarMenuFlotante(){floatingMenu.innerHTML='';SECCIONES_DATA.forEach((s,i)=>{const d=document.createElement('div');d.className='menu-dot';d.dataset.seccion=s.id;const t=document.createElement('span');t.className='tooltiptext';t.textContent=s.nombre;d.appendChild(t);d.addEventListener('click',()=>{if(i<=estadoUsuario.progreso||estadoUsuario.cursoCompletadoUnaVez)mostrarSeccion(s.id);});floatingMenu.appendChild(d);});}
        function navegarSiguiente(){const i=SECCIONES_DATA.findIndex(s=>s.id===estadoUsuario.seccionActual);if(i<SECCIONES_DATA.length-1){if(i+1>estadoUsuario.progreso)estadoUsuario.progreso=i+1;salvarEstado();mostrarSeccion(SECCIONES_DATA[i+1].id);}}
        function navegarAnterior(){const i=SECCIONES_DATA.findIndex(s=>s.id===estadoUsuario.seccionActual);if(i>0)mostrarSeccion(SECCIONES_DATA[i-1].id);}
        function validarFormularioIngreso(e){e.preventDefault();const n=document.getElementById('nombre-completo'),m=document.getElementById('email');estadoUsuario.nombre=n.value.trim()||"An√≥nimo";estadoUsuario.email=m.value.trim();estadoUsuario.esInvitado=false;navegarSiguiente();}
        function accederComoInvitado(){estadoUsuario.nombre="Invitado";estadoUsuario.esInvitado=true;navegarSiguiente();}
        window.onYouTubeIframeAPIReady=function(){if(estadoUsuario.seccionActual==='seccion-desarrollo-practico')crearReproductor();}
        function crearReproductor(){if(!videoQuizState.player&&document.getElementById('video-principal')){videoQuizState.player=new YT.Player('video-principal',{videoId:'EtU-NyNH4Qg',playerVars:{playsinline:1},events:{onReady:e=>e.target.getIframe().parentElement.classList.add('loaded'),onStateChange:onPlayerStateChange}});}
        function onPlayerStateChange(event){if(event.data==YT.PlayerState.PLAYING)iniciarRelojVerificador();else detenerRelojVerificador();}
        function iniciarRelojVerificador(){if(videoQuizState.relojVerificador)clearInterval(videoQuizState.relojVerificador);videoQuizState.relojVerificador=setInterval(()=>{const t=videoQuizState.player.getCurrentTime();for(let i=0;i<videoQuizData.length;i++)if(t>=videoQuizData[i].tiempo&&!videoQuizState.preguntasMostradas[i]){videoQuizState.player.pauseVideo();videoQuizState.preguntasMostradas[i]=true;mostrarPreguntaVideoQuiz(i);break;}},500);}
        function detenerRelojVerificador(){clearInterval(videoQuizState.relojVerificador);}
        function mostrarPreguntaVideoQuiz(index){const data=videoQuizData[index],modal=document.getElementById('video-quiz-modal'),opcionesEl=document.getElementById('opciones-video-quiz'),feedbackEl=document.getElementById('feedback-video-quiz');document.getElementById('pregunta-video-quiz').textContent=data.pregunta;opcionesEl.innerHTML='';feedbackEl.textContent='';data.opciones.forEach((opcion,i)=>{const btn=document.createElement('button');btn.textContent=opcion;btn.className='btn';btn.onclick=()=>{if(i===data.correcta){feedbackEl.textContent='¬°Correcto!';setTimeout(()=>{modal.style.display='none';videoQuizState.player.playVideo();if(videoQuizState.preguntasMostradas.filter(Boolean).length===videoQuizData.length)completarVideoQuiz();},1500);}else{feedbackEl.textContent='Int√©ntalo de nuevo.';}};opcionesEl.appendChild(btn);});modal.style.display='flex';}
        function completarVideoQuiz(){estadoUsuario.videoQuizCompletado=true;salvarEstado();actualizarUI();}
        function iniciarTestFinal(){testFinalState={preguntaActual:0,puntuacion:0,temporizador:null,tiempoRestante:1800};estadoUsuario.testFinal.intentos--;document.getElementById('intentos-restantes').textContent=estadoUsuario.testFinal.intentos;mostrarPreguntaTest();iniciarTemporizadorTest();}
        function iniciarTemporizadorTest(){const d=document.getElementById('tiempo-restante');testFinalState.temporizador=setInterval(()=>{testFinalState.tiempoRestante--;const m=Math.floor(testFinalState.tiempoRestante/60),s=testFinalState.tiempoRestante%60;d.textContent=`${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;if(testFinalState.tiempoRestante<=0)finalizarTest();},1000);}
        function mostrarPreguntaTest(){const p=testFinalData[testFinalState.preguntaActual];document.getElementById('pregunta-test-actual').innerHTML=`<h4>Pregunta ${testFinalState.preguntaActual+1}/${testFinalData.length}: ${p.pregunta}</h4>`;const oc=document.getElementById('opciones-test-final');oc.innerHTML='';p.opciones.forEach(o=>{const b=document.createElement('button');b.className='opcion-test';b.textContent=o;b.dataset.respuesta=o;b.onclick=()=>{oc.querySelectorAll('.opcion-test').forEach(i=>i.classList.remove('seleccionado'));b.classList.add('seleccionado');};oc.appendChild(b);});}
        function evaluarRespuestaTest(){const s=document.querySelector('.opcion-test.seleccionado');if(!s)return alert('Selecciona una respuesta.');const c=testFinalData[testFinalState.preguntaActual];if(s.dataset.respuesta===c.correcta)testFinalState.puntuacion++;if(testFinalState.preguntaActual<testFinalData.length-1){testFinalState.preguntaActual++;mostrarPreguntaTest();}else finalizarTest();}
        function finalizarTest(){if(testFinalState.temporizador)clearInterval(testFinalState.temporizador);estadoUsuario.testFinal.completado=true;const punt=Math.round((testFinalState.puntuacion/testFinalData.length)*100);estadoUsuario.testFinal.puntuacion=punt;const res=document.getElementById('resultado-test'),tit=document.getElementById('resultado-titulo'),txt=document.getElementById('resultado-texto'),btn=document.getElementById('btn-reintentar-test');document.getElementById('test-container').style.display='none';res.style.display='block';if(punt>=70){estadoUsuario.testFinal.aprobado=true;tit.textContent=`¬°Aprobado!`;txt.textContent=`Tu puntuaci√≥n: ${punt}%.`;}else{tit.textContent='Int√©ntalo de nuevo';txt.textContent=`Tu puntuaci√≥n: ${punt}%. Necesitas 70%.`;if(estadoUsuario.testFinal.intentos>0){btn.style.display='inline-block';btn.addEventListener('click',iniciarTestFinal,{once:true});}}salvarEstado();actualizarUI();}
        function mostrarDefinicion(e){lastFocusedElement=e.target;const t=e.target.dataset.term,m=document.getElementById('definicion-modal');if(definiciones[t]){document.getElementById('definicion-titulo').textContent=t;document.getElementById('definicion-texto').textContent=definiciones[t];m.style.display='flex';document.getElementById('cerrar-definicion').focus();}m.onclick=ev=>{if(ev.target===m)cerrarDefinicion()};document.getElementById('cerrar-definicion').onclick=cerrarDefinicion;}
        function cerrarDefinicion(){document.getElementById('definicion-modal').style.display='none';if(lastFocusedElement)lastFocusedElement.focus();}
        function otorgarInsignia(id){if(!estadoUsuario.insignias.includes(id)){estadoUsuario.insignias.push(id);salvarEstado();actualizarUI();const t=document.getElementById('badge-toast');document.getElementById('toast-icon').innerHTML=insigniasData[id].svg;document.getElementById('toast-text').textContent=`¬°Insignia: ${insigniasData[id].nombre}!`;t.style.display='flex';setTimeout(()=>t.style.display='none',4000);}}
        function guardarReflexiones(){const inputs=document.querySelectorAll('#form-metacognicion textarea');estadoUsuario.respuestasMetacognitivas={q1:inputs[0].value,q2:inputs[1].value,q3:inputs[2].value,};estadoUsuario.cursoCompletadoUnaVez=true;salvarEstado();navegarSiguiente();}
        function poblarReporteFinal(){document.getElementById('reporte-puntuacion').textContent=estadoUsuario.testFinal.puntuacion!=null?`${estadoUsuario.testFinal.puntuacion}%`:'N/A';const rc=document.getElementById('reporte-insignias');rc.innerHTML='';if(estadoUsuario.insignias.length)estadoUsuario.insignias.forEach(id=>rc.innerHTML+=`<div class="badge earned">${insigniasData[id].svg}<p>${insigniasData[id].nombre}</p></div>`);else rc.innerHTML='<p>A√∫n no has ganado insignias.</p>';}
        function mostrarCertificado(){const wrapper=document.getElementById('certificado-wrapper'),preview=document.getElementById('certificado-preview');wrapper.style.display='block';const certEl=document.createElement('div');certEl.innerHTML=generarCertificadoHTML();preview.innerHTML='';preview.appendChild(certEl.firstChild);document.getElementById('reporte-final-content').style.display='none';document.getElementById('btn-descargar-pdf').onclick=descargarCertificado;}
        function generarCertificadoHTML(){const f=new Date().toLocaleDateString('es-ES',{day:'numeric',month:'long',year:'numeric'});let iH='';estadoUsuario.insignias.forEach(id=>iH+=`<div style="display:inline-block;text-align:center;margin:0 10px;">${insigniasData[id].svg}<p style="font-size:10px;margin-top:5px;">${insigniasData[id].nombre}</p></div>`);return `<div style="width:100%;height:100%;padding:40px;box-sizing:border-box;font-family:'Georgia',serif;border:10px solid #005f73;background:#f8fafd;display:flex;flex-direction:column;justify-content:space-between;position:relative;"><div style="text-align:center;"><h1 style="font-size:48px;color:#005f73;margin:0;">Certificado</h1><p style="font-size:18px;margin-top:20px;">Se otorga a:</p><p style="font-size:36px;color:#ee9b00;margin:20px 0;">${estadoUsuario.nombre}</p></div><p style="text-align:center;font-size:18px;line-height:1.6;">Por haber completado la c√°psula educativa<br><strong>"IA: Creatividad Aumentada o Amenazada"</strong><br>con calificaci√≥n de <strong>${estadoUsuario.testFinal.puntuacion}%</strong>.</p><div style="text-align:center;"><h4>Insignias Obtenidas</h4><div>${iH}</div></div><div style="margin-top:auto;padding-top:2rem;display:flex;justify-content:space-between;align-items:flex-end;"><div style="text-align:center;"><p style="font-size:16px;margin:0;">${f}</p><hr style="border-top:1px solid #005f73;"><p style="font-size:14px;margin:0;">Fecha</p></div></div></div>`;}
        function descargarCertificado(){const e=document.getElementById('certificado-html-source');e.innerHTML=generarCertificadoHTML();html2pdf().from(e).set({margin:0,filename:`Certificado_${estadoUsuario.nombre}.pdf`,jsPDF:{unit:'px',format:'letter',orientation:'portrait'}}).save();}
        function inyectarSVGs(){Object.keys(insigniasData).forEach(id=>document.getElementById(`${id}-icon-placeholder`).innerHTML=insigniasData[id].svg);}
        init();
    });
    </script>
</body>
</html>
