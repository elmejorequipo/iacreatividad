<!DOCTYPE html>
<html lang="es-BO">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IA: Creatividad Aumentada o Amenazada</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Cápsula educativa interactiva sobre el impacto de la Inteligencia Artificial en la creatividad humana. Explore debates, videos, quizzes y obtenga un certificado.">
    <meta name="keywords" content="IA, Inteligencia Artificial, Creatividad, Educación, Tecnología Educativa, Diseño Instruccional, UAGRM, Creatividad Aumentada">
    <meta name="author" content="Equipo de Desarrollo Educativo">

    <!-- Favicon SVG Embebido -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🧠</text></svg>">
    
    <!-- CDN para html2pdf.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <!-- INICIO DEL CSS EMBEBIDO -->
    <style>
        /* [EL CSS de la respuesta anterior se mantiene aquí sin cambios] */
        :root {
            --color-primario: #005f73;
            --color-secundario: #0a9396;
            --color-fondo: #f0f8ff;
            --color-superficie: #ffffff;
            --color-texto: #0d1b2a;
            --color-texto-claro: #4a4a4a;
            --color-acento: #ee9b00;
            --color-exito: #4f7942;
            --color-error: #9b2226;
            --color-borde: #dee2e6;

            --sombra-suave: 0 4px 15px rgba(0, 95, 115, 0.1);
            --sombra-media: 0 8px 30px rgba(0, 95, 115, 0.15);
            --radio-borde: 12px;
            --transicion-suave: all 0.3s ease-in-out;
            --fuente-principal: 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Arial, sans-serif;
            --fuente-titulos: 'Georgia', 'Times New Roman', serif;
        }

        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--fuente-principal);
            background-color: var(--color-fondo);
            color: var(--color-texto);
            line-height: 1.7;
            font-size: 16px;
        }

        @media (prefers-reduced-motion: reduce) {
            html, body, *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }
        
        h1, h2, h3, h4 {
            font-family: var(--fuente-titulos);
            color: var(--color-primario);
            margin-bottom: 1rem;
            text-align: center;
        }

        p {
            margin-bottom: 1rem;
            text-align: justify;
        }
        
        a {
            color: var(--color-secundario);
            text-decoration: none;
            transition: var(--transicion-suave);
        }

        a:hover {
            text-decoration: underline;
            color: var(--color-acento);
        }

        main {
            max-width: 900px;
            margin: 2rem auto;
            padding: 2rem;
        }

        section {
            display: none; /* Se ocultan por defecto, JS las muestra */
            padding: 2.5rem;
            margin-bottom: 2rem;
            background-color: var(--color-superficie);
            border-radius: var(--radio-borde);
            box-shadow: var(--sombra-suave);
            animation: fadeIn 0.8s ease-in-out;
            border: 1px solid var(--color-borde);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .btn {
            display: inline-block;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            background-color: var(--color-secundario);
            color: white;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            text-align: center;
            transition: var(--transicion-suave);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .btn:hover:not(:disabled) {
            background-color: var(--color-primario);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }
        .btn:disabled {
            background-color: #a0a0a0;
            cursor: not-allowed;
            opacity: 0.7;
        }
        .btn-secundario {
            background-color: transparent;
            color: var(--color-secundario);
            border: 2px solid var(--color-secundario);
        }
        .btn-secundario:hover:not(:disabled) {
            background-color: var(--color-secundario);
            color: white;
        }

        .contenedor-central {
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
        }

        .glassmorphism {
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
            border-radius: var(--radio-borde);
            padding: 2rem;
        }
        
        .input-group {
            margin-bottom: 1.5rem;
            width: 100%;
            max-width: 400px;
        }
        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: var(--color-texto);
        }
        .input-group input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid var(--color-borde);
            transition: var(--transicion-suave);
        }
        .input-group input:focus {
            outline: none;
            border-color: var(--color-secundario);
            box-shadow: 0 0 0 3px rgba(10, 147, 150, 0.2);
        }
        .input-group input.invalido {
            border-color: var(--color-error);
            background-color: #fff0f0;
        }
        .mensaje-error {
            color: var(--color-error);
            font-size: 0.875rem;
            margin-top: 0.25rem;
            display: none;
        }
        
        #seccion-portada .svg-animado {
            width: 250px;
            height: 250px;
            margin: 1rem auto;
        }
        @keyframes rotate-gear {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        #gear1 {
            animation: rotate-gear 20s linear infinite;
            transform-origin: center;
        }
        #gear2 {
            animation: rotate-gear 15s linear infinite reverse;
            transform-origin: center;
        }

        #video-quiz-modal {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .video-quiz-contenido {
            background: var(--color-superficie);
            padding: 2rem;
            border-radius: var(--radio-borde);
            max-width: 600px;
            width: 100%;
            text-align: center;
        }
        .video-quiz-opciones button {
            display: block;
            width: 100%;
            margin: 0.5rem 0;
            background: #e9ecef;
            color: var(--color-texto);
        }
        .video-quiz-opciones button.seleccionado {
            background-color: var(--color-secundario);
            color: white;
        }
        #feedback-video-quiz {
            font-weight: bold;
            margin-top: 1rem;
        }
        .iframe-container {
            position: relative;
            width: 100%;
            padding-top: 56.25%; /* 16:9 Aspect Ratio */
            overflow: hidden;
            border-radius: var(--radio-borde);
            box-shadow: var(--sombra-suave);
            background: #000;
        }
        .iframe-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 0;
        }

        #opciones-test-final .opcion-test {
            display: block;
            width: 100%;
            margin: 0.5rem 0;
            padding: 1rem;
            background-color: #f8f9fa;
            border: 2px solid var(--color-borde);
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
        }
        #opciones-test-final .opcion-test:hover {
            background-color: #e9ecef;
        }
        #opciones-test-final .opcion-test.seleccionado {
            border-color: var(--color-secundario);
            background-color: #e0f7fa;
        }
        #opciones-test-final .opcion-test.correcto {
            border-color: var(--color-exito);
            background-color: #f0fff0;
        }
        #opciones-test-final .opcion-test.incorrecto {
            border-color: var(--color-error);
            background-color: #fff0f0;
        }

        .definicion {
            text-decoration: underline dotted var(--color-acento);
            cursor: pointer;
            font-weight: bold;
            color: var(--color-primario);
        }
        #definicion-modal {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 3000;
            display: none;
            justify-content: center;
            align-items: center;
        }
        #definicion-contenido {
            background: var(--color-superficie);
            padding: 2.5rem;
            border-radius: var(--radio-borde);
            max-width: 500px;
            position: relative;
        }
        #cerrar-definicion {
            position: absolute;
            top: 15px;
            right: 15px;
            background: transparent;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .rubrica-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1.5rem;
        }
        .rubrica-table th, .rubrica-table td {
            border: 1px solid var(--color-borde);
            padding: 0.75rem;
            text-align: left;
        }
        .rubrica-table th {
            background-color: #e9ecef;
        }

        #progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 8px;
            background-color: #e0e0e0;
            z-index: 1000;
        }
        #progress-bar {
            height: 100%;
            width: 0;
            background-color: var(--color-secundario);
            transition: width 0.4s ease;
        }

        #floating-menu {
            position: fixed;
            top: 50%;
            left: 10px;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(8px);
            border-radius: 20px;
            padding: 10px 5px;
            box-shadow: var(--sombra-suave);
            z-index: 999;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .menu-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #ccc;
            cursor: pointer;
            transition: var(--transicion-suave);
            position: relative;
        }
        .menu-dot:hover {
            transform: scale(1.2);
            background-color: var(--color-secundario);
        }
        .menu-dot.active {
            background-color: var(--color-primario);
            transform: scale(1.4);
        }
        .menu-dot .tooltiptext {
            visibility: hidden;
            width: 120px;
            background-color: var(--color-primario);
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;
            position: absolute;
            z-index: 1;
            left: 150%;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        .menu-dot:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        #chatbot-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background-color: var(--color-primario);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: var(--sombra-media);
            z-index: 998;
            transition: transform 0.3s ease;
        }
        #chatbot-button:hover {
            transform: scale(1.1);
        }
        #chatbot-button svg {
            width: 32px;
            height: 32px;
            fill: white;
        }
        
        #chatbot-popup {
            display: none;
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 90%;
            max-width: 400px;
            height: 600px;
            border-radius: var(--radio-borde);
            box-shadow: var(--sombra-media);
            overflow: hidden;
            z-index: 997;
            background: white;
            flex-direction: column;
        }
        #chatbot-header {
            background-color: var(--color-primario);
            color: white;
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        #cerrar-chatbot {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }
        #chatbot-popup iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .navigation-buttons {
            margin-top: 2rem;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .badge-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 1rem;
        }
        .badge {
            text-align: center;
            opacity: 0.3;
            transition: var(--transicion-suave);
        }
        .badge.earned {
            opacity: 1;
            transform: scale(1.05);
        }
        .badge-icon {
            width: 80px;
            height: 80px;
        }
        .badge p {
            font-weight: bold;
            font-size: 0.9rem;
            margin-top: 0.5rem;
            color: var(--color-primario);
            text-align: center;
        }

        #badge-toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, var(--color-secundario), var(--color-acento));
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            z-index: 4000;
            box-shadow: var(--sombra-media);
            display: none;
            align-items: center;
            gap: 15px;
            animation: toast-in 0.5s ease-out;
        }
        @keyframes toast-in {
            from { transform: translate(-50%, 100px); opacity: 0; }
            to { transform: translate(-50%, 0); opacity: 1; }
        }
        #toast-icon { width: 30px; height: 30px; }
        #toast-text { font-weight: bold; }
        
        .report-section {
            border-bottom: 1px solid var(--color-borde);
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }

        #certificado-wrapper { display: none; }

        @media print {
            body {
                background-color: white;
            }
            #app-container, .seccion-final, #reporte-final-content, #certificado-preview {
                margin: 0;
                padding: 0;
                box-shadow: none;
                border: none;
            }
            main {
                max-width: 100%;
            }
            #reporte-final, #seccion-certificado, #reporte-final-content {
                display: block !important;
            }
            #certificado-preview {
                width: 100%;
                height: 100%;
            }
            .no-print {
                display: none !important;
            }
        }
        
        @media (max-width: 768px) {
            body { font-size: 15px; }
            main {
                margin: 1rem;
                padding: 1rem;
            }
            section {
                padding: 1.5rem;
            }
            #floating-menu {
                display: none;
            }
        }
    </style>
    <!-- FIN DEL CSS EMBEBIDO -->
</head>
<body>
    <div id="app-container">
        <!-- SE MANTIENE TODO EL HTML ANTERIOR HASTA LA SECCIÓN DE DESARROLLO PRÁCTICO... -->

        <header id="progress-container" class="no-print">
            <div id="progress-bar"></div>
        </header>

        <nav id="floating-menu" class="no-print">
            <!-- Los puntos del menú se generan con JS -->
        </nav>

        <div id="chatbot-button" class="no-print" title="Habla con un experto">
            <svg viewBox="0 0 24 24"><path d="M12,2A10,10,0,0,0,2,12C2,16.42,5.58,20,10,20C10.55,20,11,20.45,11,21C11,21.55,10.55,22,10,22A12,12,0,0,1,12,0A12,12,0,0,1,24,12C24,18.67,18,24,12,24V22A10,10,0,0,0,22,12A10,10,0,0,0,12,2M7.5,10.5A1.5,1.5,0,1,1,9,12A1.5,1.5,0,0,1,7.5,10.5M16.5,10.5A1.5,1.5,0,1,1,15,12A1.5,1.5,0,0,1,16.5,10.5M12,7A2,2,0,0,0,10,9A2,2,0,0,0,12,11A2,2,0,0,0,14,9A2,2,0,0,0,12,7Z" fill="white"/></svg>
        </div>
        
        <div id="chatbot-popup" class="no-print">
            <div id="chatbot-header">
                <span>Asistente IA</span>
                <button id="cerrar-chatbot">×</button>
            </div>
            <iframe src="https://poe.com/Prof_Luis_Andia" title="Chatbot Asistente"></iframe>
        </div>

        <div id="definicion-modal" role="dialog" aria-modal="true" aria-labelledby="definicion-titulo">
            <div id="definicion-contenido">
                <button id="cerrar-definicion" aria-label="Cerrar">×</button>
                <h3 id="definicion-titulo"></h3>
                <p id="definicion-texto"></p>
            </div>
        </div>

        <div id="badge-toast" role="alert">
            <span id="toast-icon"></span>
            <span id="toast-text"></span>
        </div>

        <!-- ===== CONTENIDO PRINCIPAL Y SECCIONES PEDAGÓGICAS ===== -->
        <main>
            <!-- ============================================== -->
            <!-- ======== 1. SECCIÓN: FORMULARIO DE INGRESO ======= -->
            <!-- ============================================== -->
            <section id="seccion-ingreso">
                <div class="contenedor-central">
                    <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user-check"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><polyline points="17 11 19 13 23 9"></polyline></svg>
                    <h1>¡Te damos la bienvenida!</h1>
                    <p class="intro-text">Hola, futuro explorador de la creatividad. Estás a punto de iniciar una cápsula educativa sobre el fascinante cruce entre <strong>Inteligencia Artificial y Creatividad</strong>. ¡Prepárate para un viaje de descubrimiento!</p>
                    <p class="info-text" style="font-size: 0.9em; color: var(--color-texto-claro);">Para poder generar tu certificado de participación al final del curso, por favor, ingresa tus datos. Prometemos no enviarte spam, ¡a menos que sea spam de conocimiento!</p>
                    <form id="form-ingreso">
                        <div class="input-group">
                            <label for="nombre-completo">Nombre Completo</label>
                            <input type="text" id="nombre-completo" name="nombre" placeholder="Ej: Juana Azurduy de Padilla" required>
                            <div class="mensaje-error">El nombre es obligatorio.</div>
                        </div>
                        <div class="input-group">
                            <label for="email">Correo Electrónico</label>
                            <input type="email" id="email" name="email" placeholder="Ej: tu.correo@dominio.com" required>
                            <div class="mensaje-error">Por favor, ingresa un correo válido.</div>
                        </div>
                        <div class="input-group">
                            <label for="telefono">Teléfono (Opcional)</label>
                            <input type="tel" id="telefono" name="telefono" placeholder="Ej: 71234567">
                        </div>
                        <button type="submit" class="btn">Empezar la Aventura</button>
                    </form>
                </div>
            </section>
            
            <section id="seccion-portada" style="text-align:center;">
                <h1 style="font-size: 2.5em; line-height: 1.2;">IA: Creatividad Aumentada o Amenaza</h1>
                 <svg class="svg-animado" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:var(--color-secundario);stop-opacity:1" />
                            <stop offset="100%" style="stop-color:var(--color-primario);stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <path fill="#e0f7fa" d="M38.2,-58.5C52.2,-52,68.1,-43,76.5,-30.2C84.9,-17.4,85.7,-0.7,80.1,13C74.6,26.7,62.7,37.3,50.7,46.2C38.7,55.1,26.6,62.3,13.7,66.6C0.8,70.8,-12.8,72.2,-25.9,68.4C-39.1,64.7,-51.7,55.9,-61.9,44.9C-72.1,33.9,-79.8,20.8,-80.7,6.8C-81.6,-7.1,-75.7,-21.9,-66.1,-32.8C-56.5,-43.7,-43.3,-50.7,-30.2,-56.9C-17.2,-63,-4.2,-68.3,8.7,-69.6C21.6,-70.9,44.2,-68.5,38.2,-58.5Z" transform="translate(100 100)" />
                    <g transform="translate(100, 100)">
                        <path id="gear1" d="M50,0 A50,50 0 0,1 -50,0 A50,50 0 0,1 50,0 M40,0 L-40,0 M0,40 L0,-40 M28.28,28.28 L-28.28,-28.28 M-28.28,28.28 L28.28,-28.28" fill="none" stroke="rgba(0, 95, 115, 0.5)" stroke-width="5"/>
                        <path id="gear2" d="M30,0 A30,30 0 0,1 -30,0 A30,30 0 0,1 30,0 M25,0 L-25,0 M0,25 L0,-25 M17.67,17.67 L-17.67,-17.67 M-17.67,17.67 L17.67,-17.67" fill="none" stroke="rgba(238, 155, 0, 0.7)" stroke-width="3"/>
                        <text x="0" y="5" font-size="20" fill="var(--color-primario)" text-anchor="middle" font-family="var(--fuente-titulos)" font-weight="bold">IA</text>
                    </g>
                </svg>
                <p>Explora cómo la Inteligencia Artificial está remodelando los límites de la creatividad humana.</p>
                <button class="btn btn-next">¡Comenzar ahora!</button>
                <div class="navigation-buttons">
                    <button class="btn btn-secundario btn-prev" disabled>Anterior</button>
                    <button class="btn btn-next">Siguiente</button>
                </div>
            </section>
            
            <section id="seccion-introduccion">
                <h2>Una nueva frontera para el conocimiento</h2>
                <div class="contenedor-central">
                    <svg width="80" height="80" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><path d="M8.5 12.5L7 14l-1.5-1.5L7 11l1.5 1.5zM12.5 8.5L11 10l-1.5-1.5L11 7l1.5 1.5zM15.5 14.5L14 16l-1.5-1.5L14 13l1.5 1.5z"/><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2S2 6.477 2 12s4.477 10 10 10zM15 9.5a.5.5 0 1 0 0-1a.5.5 0 0 0 0 1zM9 15.5a.5.5 0 1 0 0-1a.5.5 0 0 0 0 1z"/></g></svg>
                </div>
                <h3>Objetivos de Aprendizaje:</h3>
                <p>Al finalizar esta cápsula, como docente universitario, serás capaz de:</p>
                <ul>
                    <li><strong>Analizar críticamente</strong> el doble rol de la IA como herramienta potenciadora y como posible amenaza para la creatividad en el contexto académico.</li>
                    <li><strong>Diferenciar</strong> entre el trabajo estudiantil original que integra IA como apoyo y el plagio académico basado en IA.</li>
                    <li><strong>Diseñar consignas de evaluación</strong> que fomenten una sinergia humano-IA, promoviendo la "creatividad aumentada".</li>
                    <li><strong>Aplicar estrategias pedagógicas</strong> para guiar a los estudiantes en el uso ético y efectivo de herramientas de IA generativa.</li>
                </ul>

                <h3>Punto de Partida: Un Dilema muy Cruceño</h3>
                <div class="glassmorphism" style="font-style: italic; border-left: 5px solid var(--color-secundario); padding-left: 2rem;">
                    <h4>"El Informe Perfecto"</h4>
                    <p>La Dra. Elena Vargas, catedrática de Sociología en la U.A.G.R.M., sostiene con desconcierto un informe estudiantil. El tema: el impacto de los cortes de agua de SAGUAPAC, un problema que todo cruceño conoce de cerca. El informe es... impecable. Demasiado.</p>
                    <p>"¡Mire esto, Dr. Mateo!", le dice a su colega de Comunicación. "La redacción, el análisis de datos, ¡hasta los testimonios! Cita a una 'madre de familia' que habla como un economista y a un 'dueño de pensión' que parece líder sindical. ¡Esto no es trabajo de campo, es una simulación! ¡Es una IA!"</p>
                    <p>Elena, defensora de la sociología "con los pies en el barro", está a punto de anular el trabajo por fraude. Pero Mateo, curioso y al día con la tecnología, le pide ver la consigna. Tras leerla, argumenta con respeto: "Doctora, la consigna pedía analizar datos y dar ejemplos de testimonios... Describe perfectamente una tarea en la que una IA es experta. Quizás el trabajo del estudiante no fue recoger los testimonios, sino construir los 'prompts', enseñar a la IA cómo habla un vecino del D-8. Es una especie de... etnografía digital."</p>
                    <p>La palabra resuena. Elena mira el informe, ya no como un fraude, sino como un artefacto de un futuro que ha llegado sin avisar. "Entonces...", murmura, "si la forma de investigar está cambiando, nosotros tenemos que cambiar la forma en que la enseñamos".</p>
                    <p>Mateo asiente. "Ese es el meollo del asunto. La pregunta no es si el alumno hizo la tarea. La pregunta es: frente a un estudiante que puede simular la realidad con IA, nuestra capacidad como docentes... <strong>¿está aumentada o está amenazada?</strong>"</p>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-secundario btn-prev">Anterior</button>
                    <button class="btn btn-next">Siguiente</button>
                </div>
            </section>
            
            <section id="seccion-activacion">
                <h2>Activando Conocimientos Previos</h2>
                <div class="contenedor-central">
                    <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 1 1-6.219-8.56"></path><path d="M14 4h2v2h-2zM12 21a9 9 0 0 0 9-9h-2a7 7 0 0 1-7 7v2zM6.343 6.343l1.414 1.414A5 5 0 0 0 5 12H3a7 7 0 0 1 3.343-5.657zM17.657 17.657l-1.414-1.414A5 5 0 0 0 19 12h2a7 7 0 0 1-3.343 5.657z"></path><path d="M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8z"></path><path d="M12 10a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"></path></svg>
                </div>
                <p><strong>Instrucciones:</strong> Haz clic en una tarjeta y luego en otra para encontrar las parejas de conceptos relacionados. ¡No hay límite de tiempo, el objetivo es explorar!</p>
                <div class="iframe-container">
                    <iframe allow="fullscreen; autoplay; allow-top-navigation-by-user-activation" allowfullscreen width="795" height="690" frameborder="0" src="https://es.educaplay.com/juego/24152723-juego_de_parejas_ia_y_creatividad.html" title="Juego Educaplay: Parejas IA y Creatividad"></iframe>
                </div>
                <div class="navigation-buttons">
                    <button class="btn btn-secundario btn-prev">Anterior</button>
                    <button class="btn btn-next">Siguiente</button>
                </div>
            </section>
            
            <!-- ======== 5. SECCIÓN: DESARROLLO PRÁCTICO (MODIFICADA) ======== -->
            <section id="seccion-desarrollo-practico">
                <h2>Conectando con la Realidad: Video y Reflexión</h2>
                <p>Ahora, te invitamos a ver la charla TEDx de Julián Larrauri. Mientras lo haces, el video se detendrá en <strong>4 momentos clave</strong> para que respondas a una pregunta. No podrás continuar hasta responder correctamente. ¡Presta mucha atención!</p>
                
                <div class="iframe-container">
                    <!-- El iframe ahora es solo un div placeholder. JS lo reemplazará. -->
                    <div id="video-principal"></div>
                </div>
                
                <div id="video-quiz-modal" role="dialog">
                    <div class="video-quiz-contenido">
                        <h3 id="pregunta-video-quiz"></h3>
                        <div id="opciones-video-quiz" class="video-quiz-opciones"></div>
                        <p id="feedback-video-quiz"></p>
                    </div>
                </div>

                <h3>Insignia "Inquisidor Digital"</h3>
                <div class="badge-container">
                    <div class="badge" id="badge-explorador">
                        <div class="badge-icon" id="badge-explorador-icon-placeholder">
                             <svg viewBox="0 0 100 100"><rect width="100" height="100" fill="#ddd"/><text x="50" y="50" text-anchor="middle" dominant-baseline="central" font-size="12">Explorador</text></svg>
                        </div>
                        <p>Inquisidor Digital</p>
                    </div>
                </div>
                <p>Al completar esta sección, obtendrás tu primera insignia.</p>
                
                <div class="navigation-buttons">
                    <button class="btn btn-secundario btn-prev">Anterior</button>
                    <button class="btn btn-next" disabled>Siguiente</button>
                </div>
            </section>
            
            <!-- EL RESTO DE LAS SECCIONES SE MANTIENEN IGUAL -->
            <!-- ... se omite por brevedad, pero estaría aquí ... -->

             <section id="seccion-desarrollo-teorico">
                <h2>Profundizando: Teoría y Conceptos Clave</h2>
                 <p>Tras la reflexión inicial y el análisis del video, es momento de construir un andamiaje teórico sólido. En esta sección, desglosaremos los conceptos fundamentales que subyacen al debate sobre IA y creatividad.</p>

                <div class="contenedor-central" style="margin-bottom:2rem;">
                     <!-- SVG Icon: Book Open -->
                     <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                </div>
                 <!-- ... -->
                <div class="navigation-buttons">
                    <button class="btn btn-secundario btn-prev">Anterior</button>
                    <button class="btn btn-next">Siguiente</button>
                </div>
            </section>

             <section id="seccion-evaluacion-formativa">
                 <h2>Poniendo a Prueba el Aprendizaje</h2>
                  <!-- ... -->
                <div class="navigation-buttons">
                    <button class="btn btn-secundario btn-prev">Anterior</button>
                    <button class="btn btn-next">Siguiente</button>
                </div>
             </section>

             <section id="seccion-evaluacion">
                <h2>Evaluación Final: Demuestra tu Dominio</h2>
                 <!-- ... -->
                <div class="navigation-buttons">
                    <button class="btn btn-secundario btn-prev">Anterior</button>
                    <button class="btn btn-next" disabled>Siguiente (Completa el test)</button>
                </div>
             </section>

             <section id="seccion-sintesis">
                 <h2>Síntesis: Las Grandes Ideas</h2>
                  <!-- ... -->
                 <div class="navigation-buttons">
                    <button class="btn btn-secundario btn-prev">Anterior</button>
                    <button class="btn btn-next">Siguiente</button>
                </div>
             </section>
             <section id="seccion-cierre">
                <h2>Cierre: Mirando Hacia Adentro y Hacia Adelante</h2>
                 <!-- ... -->
                <div class="navigation-buttons">
                    <button class="btn btn-secundario btn-prev">Anterior</button>
                </div>
            </section>
             <section id="seccion-final">
                 <div id="reporte-final-content" class="seccion-final">
                 <!-- ... -->
                 </div>
                 <div id="certificado-wrapper" class="seccion-final">
                 <!-- ... -->
                 </div>
                 <div class="navigation-buttons">
                    <button class="btn btn-secundario btn-prev">Anterior</button>
                 </div>
            </section>

        </main>
        
        <footer class="no-print" style="text-align: center; padding: 2rem; color: var(--color-texto-claro);">
            <p>Una cápsula educativa diseñada por el Equipo de Desarrollo Creativo.</p>
            <button id="btn-borrar-datos" style="font-size: 0.8em; background:none; border:none; color:var(--color-secundario); cursor:pointer;">Borrar mis datos y reiniciar</button>
        </footer>
    </div>
    
    <!-- 1. Cargar la API de YouTube IFrame asíncronamente -->
    <script src="https://www.youtube.com/iframe_api"></script>

    <!-- INICIO DEL JAVASCRIPT EMBEBIDO (MODIFICADO) -->
    <script>
    // 2. Este código se ejecuta después de que la API de YouTube se carga.
    // Toda la lógica ahora vive dentro de `document.addEventListener` para asegurar que el DOM está listo.
    
    document.addEventListener('DOMContentLoaded', () => {

        // ===========================================
        // #1. DEFINICIÓN DE VARIABLES Y ESTADO GLOBAL
        // ===========================================
        const secciones = document.querySelectorAll('main > section');
        const progressBar = document.getElementById('progress-bar');
        const floatingMenu = document.getElementById('floating-menu');

        let estadoUsuario = {
            nombre: '',
            email: '',
            telefono: '',
            seccionActual: 'seccion-ingreso',
            progreso: 0,
            videoQuizCompletado: false, // Nuevo estado
            testFinal: {
                puntuacion: null,
                intentos: 3,
                tiempo: 0,
                completado: false,
                aprobado: false,
            },
            insignias: [],
            respuestasMetacognitivas: {}
        };
        
        const SECCIONES_DATA = [
            { id: 'seccion-ingreso', nombre: 'Ingreso' },
            { id: 'seccion-portada', nombre: 'Portada' },
            { id: 'seccion-introduccion', nombre: 'Introducción' },
            { id: 'seccion-activacion', nombre: 'Activación' },
            { id: 'seccion-desarrollo-practico', nombre: 'Práctica' },
            { id: 'seccion-desarrollo-teorico', nombre: 'Teoría' },
            { id: 'seccion-evaluacion-formativa', nombre: 'Formativa' },
            { id: 'seccion-evaluacion', nombre: 'Evaluación' },
            { id: 'seccion-sintesis', nombre: 'Síntesis' },
            { id: 'seccion-cierre', nombre: 'Cierre' },
            { id: 'seccion-final', nombre: 'Reporte' }
        ];

        const TOTAL_SECCIONES_PROGRESO = SECCIONES_DATA.length;
        
        const videoQuizData = [
            // Los tiempos están en segundos
            { tiempo: 59, pregunta: 'Según el ponente, ¿qué emoción transmitía el estudiante que le preguntó sobre seguir aprendiendo a dibujar?', opciones: ['Entusiasmo y curiosidad', 'Pesadumbre y falta de ilusión', 'Enojo y frustración', 'Indiferencia total'], correcta: 1 },
            { tiempo: 169, pregunta: 'El ponente cita a Picasso: "Los ordenadores son inútiles, solo pueden darnos respuestas". ¿Qué quiere destacar con esta frase?', opciones: ['La inutilidad de la tecnología', 'La superioridad de las respuestas', 'La importancia de hacerse las preguntas correctas', 'Que las respuestas son la clave'], correcta: 2 },
            { tiempo: 359, pregunta: '¿Qué consecuencia positiva tuvo la invención de la fotografía para la pintura?', opciones: ['Hizo que la pintura se volviera obsoleta.', 'La liberó de la obligación de copiar la realidad, permitiendo nuevos movimientos.', 'Confirmó la superioridad de la pintura.', 'No tuvo ninguna consecuencia relevante.'], correcta: 1 },
            { tiempo: 588, pregunta: '¿Cuál de las siguientes características NO es algo que los humanos aporten y las máquinas no, según el ponente?', opciones: ['Originalidad', 'Destreza y criterio', 'Velocidad y cantidad de datos', 'Visión y objetivo final'], correcta: 2 }
        ];
        
        // Objeto para el estado del video-quiz
        let videoQuizState = {
            player: null, // El objeto del reproductor de YouTube
            relojVerificador: null, // El ID del `setInterval`
            preguntaActual: -1,
            preguntasMostradas: [] // Para no mostrar la misma pregunta dos veces
        };

        // ... El resto de las definiciones (testFinalData, definiciones, etc.) se mantienen sin cambios ...
        const testFinalData = [ { pregunta: 'En la historia "El Informe Perfecto", ¿cuál es el concepto clave que introduce el Dr. Mateo para reinterpretar el trabajo del estudiante?', opciones: ['Plagio digital', 'Creatividad Aumentada', 'Etnografía Digital', 'Fraude Académico'], correcta: 'Etnografía Digital' }, { pregunta: 'Según el ponente del video TEDx, ¿cuál es la habilidad humana que se desarrolla con horas de práctica y permite diferenciar entre las múltiples respuestas que da una IA?', opciones: ['La inspiración', 'El criterio', 'La originalidad', 'La velocidad'], correcta: 'El criterio' }, { pregunta: 'De acuerdo al modelo de las "4 P" de la creatividad, ¿en qué dos áreas impacta la IA de forma más directa?', opciones: ['Persona y Proceso', 'Proceso y Producto', 'Producto y Presión', 'Persona y Presión'], correcta: 'Proceso y Producto' }, { pregunta: '¿Cuál es la función principal del sistema de video-quiz implementado en esta cápsula?', opciones: ['Evaluar la memoria a corto plazo', 'Asegurar una visualización pasiva del contenido', 'Fomentar el aprendizaje activo y la atención sostenida', 'Medir la velocidad de lectura del estudiante'], correcta: 'Fomentar el aprendizaje activo y la atención sostenida' }, { pregunta: '¿Qué significa usar la IA como "colaborador creativo" en lugar de solo como "herramienta"?', opciones: [ 'Dejar que la IA haga todo el trabajo.', 'Usarla solo para corregir errores gramaticales.', 'Integrarla en el proceso de ideación para que proponga caminos inesperados y nuevas combinaciones.', 'Limitar su uso a la búsqueda de información.' ], correcta: 'Integrarla en el proceso de ideación para que proponga caminos inesperados y nuevas combinaciones.' }, { pregunta: 'Al final de la cápsula, se presenta una rúbrica alineada con el nivel "Crear" de Bloom. ¿Cuál es el propósito de esta herramienta?', opciones: [ 'Asignar una calificación numérica a las respuestas abiertas.', 'Ofrecer un modelo para que los estudiantes copien sus respuestas.', 'Limitar la creatividad en las respuestas.', 'Proporcionar un marco para la autoevaluación de la profundidad y originalidad de la reflexión personal.' ], correcta: 'Proporcionar un marco para la autoevaluación de la profundidad y originalidad de la reflexión personal.' } ];
        const definiciones = { 'Criterio': 'En este contexto, el Criterio es la capacidad desarrollada, a través de la experiencia y el conocimiento profundo, para juzgar la calidad, relevancia y adecuación de una idea o producto. Es lo que permite a un experto elegir la mejor opción entre miles que una IA puede generar.', 'Etnografía Digital': 'Es la adaptación de los métodos de la etnografía (estudio de pueblos y culturas) al mundo digital. En lugar de observar personas en un espacio físico, se investigan comunidades, interacciones y artefactos culturales en plataformas en línea, como redes sociales o foros.', 'Creatividad Computacional': 'Un subcampo de la inteligencia artificial dedicado a construir software que exhibe comportamientos que serían considerados creativos en humanos. Va más allá de la simple generación; busca la novedad y el valor en sus creaciones.' };
        let testFinalState = { preguntaActual: 0, puntuacion: 0, respuestasUsuario: [], temporizador: null, tiempoRestante: 30 * 60, };
        
        
        // ============================================
        // #A. NUEVA LÓGICA DE VIDEO-QUIZ CON YOUTUBE API
        // ============================================
        
        // 3. Esta función global se llama automáticamente cuando la API de YouTube está lista.
        window.onYouTubeIframeAPIReady = function() {
            // El reproductor se creará cuando el usuario navegue a la sección correcta.
        };

        // 4. Función para crear el reproductor
        function crearReproductor() {
             if (!videoQuizState.player && document.getElementById('video-principal')) {
                videoQuizState.player = new YT.Player('video-principal', {
                    height: '100%',
                    width: '100%',
                    videoId: 'EtU-NyNH4Qg',
                    playerVars: {
                        'playsinline': 1,
                        'controls': 1, // Muestra controles para que el usuario pueda interactuar
                        'rel': 0 // No mostrar videos relacionados al final
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });
             }
        }
        
        // 5. La API llama a esta función cuando el video está listo.
        function onPlayerReady(event) {
            // El video está listo para ser reproducido. No hacemos nada hasta que el usuario le de Play.
        }

        // 6. La API llama a esta función cuando el estado del video cambia (play, pause, etc.).
        function onPlayerStateChange(event) {
            if (event.data == YT.PlayerState.PLAYING) {
                // 6.a. Si el video está en reproducción, iniciamos nuestro reloj verificador.
                iniciarRelojVerificador();
            } else {
                // 6.b. Si se pausa, se detiene o termina, detenemos el reloj.
                detenerRelojVerificador();
            }
        }

        function iniciarRelojVerificador() {
             // Limpiar cualquier reloj anterior
            if(videoQuizState.relojVerificador) clearInterval(videoQuizState.relojVerificador);

            videoQuizState.relojVerificador = setInterval(() => {
                const tiempoActual = videoQuizState.player.getCurrentTime();
                
                // Comprobar si hay alguna pregunta para el tiempo actual
                for(let i=0; i < videoQuizData.length; i++) {
                    // Si el tiempo actual ha pasado el punto de la pregunta Y no se ha mostrado ya
                    if (tiempoActual >= videoQuizData[i].tiempo && !videoQuizState.preguntasMostradas[i]) {
                         // ¡Es momento de mostrar la pregunta!
                        videoQuizState.player.pauseVideo(); // Pausamos el video
                        videoQuizState.preguntasMostradas[i] = true; // La marcamos como mostrada
                        videoQuizState.preguntaActual = i;
                        mostrarPreguntaVideoQuiz(i);
                        break; // Salimos del bucle para mostrar solo una pregunta a la vez
                    }
                }
            }, 500); // Revisamos cada medio segundo
        }
        
        function detenerRelojVerificador() {
            clearInterval(videoQuizState.relojVerificador);
        }

        function mostrarPreguntaVideoQuiz(index) {
            const preguntaData = videoQuizData[index];
            const modal = document.getElementById('video-quiz-modal');
            document.getElementById('pregunta-video-quiz').textContent = preguntaData.pregunta;
            const opcionesEl = document.getElementById('opciones-video-quiz');
            opcionesEl.innerHTML = '';
            const feedbackEl = document.getElementById('feedback-video-quiz');
            feedbackEl.textContent = '';
            
            preguntaData.opciones.forEach((opcion, i) => {
                const btn = document.createElement('button');
                btn.textContent = opcion;
                btn.className = 'btn';
                btn.onclick = () => {
                    if (i === preguntaData.correcta) {
                        feedbackEl.textContent = '¡Correcto!';
                        feedbackEl.style.color = 'var(--color-exito)';
                        setTimeout(() => {
                            modal.style.display = 'none';
                            videoQuizState.player.playVideo(); // Reanudamos el video
                            // Comprobamos si fue la última pregunta
                            if(videoQuizState.preguntasMostradas.filter(Boolean).length === videoQuizData.length){
                                 completarVideoQuiz();
                            }
                        }, 1500);
                    } else {
                        btn.style.borderColor = 'var(--color-error)';
                        feedbackEl.textContent = 'Inténtalo de nuevo.';
                        feedbackEl.style.color = 'var(--color-error)';
                    }
                };
                opcionesEl.appendChild(btn);
            });
            modal.style.display = 'flex';
        }

        function completarVideoQuiz() {
            otorgarInsignia('explorador', 'Inquisidor Digital');
            estadoUsuario.videoQuizCompletado = true;
            document.querySelector('#seccion-desarrollo-practico .btn-next').disabled = false;
            salvarEstado();
            alert("¡Felicidades! Has completado el video-quiz.");
        }
        // ... fin de la lógica nueva
        
        // ... se mantiene toda la lógica de los otros módulos (formularios, test final, etc.) ...
        
        function init() {
            cargarEstado();
            generarMenuFlotante();
            mostrarSeccion(estadoUsuario.seccionActual);
            actualizarUI();
            inyectarSVGs();
            adjuntarEventListeners();
            if (estadoUsuario.nombre) { document.querySelectorAll('.nombre-usuario').forEach(span => span.textContent = estadoUsuario.nombre); document.getElementById('nombre-completo').value = estadoUsuario.nombre; document.getElementById('email').value = estadoUsuario.email; document.getElementById('telefono').value = estadoUsuario.telefono; }
        }
        function salvarEstado() { try { localStorage.setItem('estadoUsuarioIA', JSON.stringify(estadoUsuario)); } catch(e) { console.error("Error guardando estado:", e); } }
        function cargarEstado() { const estadoGuardado = localStorage.getItem('estadoUsuarioIA'); if (estadoGuardado) { estadoUsuario = JSON.parse(estadoGuardado); } }
        function reiniciarCurso() { if(confirm('¿Estás seguro de que quieres borrar todos tus datos y reiniciar el curso?')) { localStorage.removeItem('estadoUsuarioIA'); if (videoQuizState.relojVerificador) clearInterval(videoQuizState.relojVerificador); if (testFinalState.temporizador) clearInterval(testFinalState.temporizador); window.location.reload(); } }
        
        function mostrarSeccion(idSeccion) {
             let seccionEncontrada = false;
             secciones.forEach(s => {
                if (s.id === idSeccion) { s.style.display = 'block'; seccionEncontrada = true; } else { s.style.display = 'none'; }
             });
             if (!seccionEncontrada) { 
                 if (idSeccion === 'seccion-final') { document.getElementById('seccion-final').style.display = 'block'; } else { document.getElementById('seccion-ingreso').style.display = 'block'; idSeccion = 'seccion-ingreso'; }
             }
             estadoUsuario.seccionActual = idSeccion;
             actualizarProgreso();
             salvarEstado();
             window.scrollTo(0, 0);
             gestionarAccionesAlEntrarSeccion(idSeccion);
        }
        function gestionarAccionesAlEntrarSeccion(idSeccion) {
            switch(idSeccion) {
                case 'seccion-desarrollo-practico':
                    // Si YT está listo y no hay player, crearlo.
                    if (typeof YT !== 'undefined' && YT.Player) {
                        crearReproductor();
                    }
                    break;
                case 'seccion-desarrollo-teorico':
                    otorgarInsignia('teorico', 'Arquitecto de Conceptos'); break;
                 case 'seccion-evaluacion-formativa':
                    otorgarInsignia('formativo', 'Catalizador de Ideas'); break;
                case 'seccion-evaluacion':
                    if (estadoUsuario.testFinal.intentos > 0 && !estadoUsuario.testFinal.aprobado) { iniciarTestFinal(); } 
                    else if (estadoUsuario.testFinal.aprobado) { finalizarTest(); }
                    break;
            }
            actualizarUI();
        }

        function actualizarUI() {
             document.querySelectorAll('.nombre-usuario').forEach(span => { span.textContent = estadoUsuario.nombre ? estadoUsuario.nombre : 'participante'; });
             const indiceActual = SECCIONES_DATA.findIndex(s => s.id === estadoUsuario.seccionActual);
             document.querySelectorAll('.btn-prev').forEach(btn => btn.disabled = (indiceActual === 0));
             document.querySelectorAll('.btn-next').forEach(btn => {
                 let deshabilita = (indiceActual >= TOTAL_SECCIONES_PROGRESO - 1);
                 if (estadoUsuario.seccionActual === 'seccion-desarrollo-practico' && !estadoUsuario.videoQuizCompletado) deshabilita = true;
                 if (estadoUsuario.seccionActual === 'seccion-evaluacion' && !estadoUsuario.testFinal.completado) deshabilita = true;
                 btn.disabled = deshabilita;
             });
        }
        // ... (resto de funciones de UI y navegación sin cambios)
        function actualizarProgreso() { const indiceActual = SECCIONES_DATA.findIndex(s => s.id === estadoUsuario.seccionActual); const porcentaje = (indiceActual / (TOTAL_SECCIONES_PROGRESO - 1)) * 100; progressBar.style.width = `${porcentaje}%`; document.querySelectorAll('.menu-dot').forEach((dot, index) => { dot.classList.toggle('active', index === indiceActual); }); }
        function generarMenuFlotante() { floatingMenu.innerHTML = ''; SECCIONES_DATA.forEach((sec) => { const dot = document.createElement('div'); dot.className = 'menu-dot'; dot.dataset.seccion = sec.id; const tooltip = document.createElement('span'); tooltip.className = 'tooltiptext'; tooltip.textContent = sec.nombre; dot.appendChild(tooltip); dot.addEventListener('click', () => { const indiceTarget = SECCIONES_DATA.findIndex(s => s.id === sec.id); const indiceProgresoMax = estadoUsuario.progreso; if (indiceTarget <= indiceProgresoMax) { mostrarSeccion(sec.id); } }); floatingMenu.appendChild(dot); }); }
        function navegarSiguiente() { const indiceActual = SECCIONES_DATA.findIndex(s => s.id === estadoUsuario.seccionActual); if (indiceActual < TOTAL_SECCIONES_PROGRESO - 1) { const nuevoIndice = indiceActual + 1; estadoUsuario.progreso = Math.max(estadoUsuario.progreso, nuevoIndice); mostrarSeccion(SECCIONES_DATA[nuevoIndice].id); } }
        function navegarAnterior() { const indiceActual = SECCIONES_DATA.findIndex(s => s.id === estadoUsuario.seccionActual); if (indiceActual > 0) { if (estadoUsuario.seccionActual === 'seccion-final' && document.getElementById('certificado-wrapper').style.display === 'block'){ document.getElementById('reporte-final-content').style.display = 'block'; document.getElementById('certificado-wrapper').style.display = 'none'; return; } mostrarSeccion(SECCIONES_DATA[indiceActual - 1].id); } }
        
        // ... Lógica de formularios
        function debounce(func, delay) { let timeout; return function(...args) { clearTimeout(timeout); timeout = setTimeout(() => func.apply(this, args), delay); }; }
        function validarFormularioIngreso(e) { e.preventDefault(); const nombreInput = document.getElementById('nombre-completo'); const emailInput = document.getElementById('email'); let esValido = true; if(nombreInput.value.trim() === '') { nombreInput.classList.add('invalido'); nombreInput.nextElementSibling.style.display = 'block'; esValido = false; } else { nombreInput.classList.remove('invalido'); nombreInput.nextElementSibling.style.display = 'none'; } const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/; if(!emailRegex.test(emailInput.value)) { emailInput.classList.add('invalido'); emailInput.nextElementSibling.style.display = 'block'; esValido = false; } else { emailInput.classList.remove('invalido'); emailInput.nextElementSibling.style.display = 'none'; } if(esValido) { estadoUsuario.nombre = nombreInput.value.trim(); estadoUsuario.email = emailInput.value.trim(); estadoUsuario.telefono = document.getElementById('telefono').value.trim(); document.querySelectorAll('.nombre-usuario').forEach(span => span.textContent = estadoUsuario.nombre); navegarSiguiente(); } }
        function guardarReflexiones() { const r1 = document.getElementById('reflexion1').value.trim(); const r2 = document.getElementById('reflexion2').value.trim(); const r3 = document.getElementById('reflexion3').value.trim(); if (!r1 || !r2 || !r3) { alert("Por favor, completa todas las reflexiones."); return; } estadoUsuario.respuestasMetacognitivas = { reflexion1: r1, reflexion2: r2, reflexion3: r3 }; poblarReporteFinal(); mostrarSeccion('seccion-final'); }

        // ... lógica de insignias y UI de certificado sin cambios...
        const insigniasData = { 'explorador': { nombre: 'Inquisidor Digital', svg: `<svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M50 2L95 25V75L50 98L5 75V25L50 2Z" fill="#e0f7fa"/><path d="M50 2L95 25V75L50 98L5 75V25L50 2Z" stroke="#005f73" stroke-width="3"/><path d="M50 35C41.7157 35 35 41.7157 35 50C35 58.2843 41.7157 65 50 65C58.2843 65 65 58.2843 65 50C65 41.7157 58.2843 35 50 35ZM50 60C44.4772 60 40 55.5228 40 50C40 44.4772 44.4772 40 50 40C55.5228 40 60 44.4772 60 50C60 55.5228 55.5228 60 50 60Z" fill="#0a9396"/><line x1="50" y1="65" x2="50" y2="75" stroke="#0a9396" stroke-width="3"/><text x="50" y="55" font-family="Arial" font-size="18" fill="white" text-anchor="middle">?</text></svg>` }, 'teorico': { nombre: 'Arquitecto de Conceptos', svg: `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M50 2L95 25V75L50 98L5 75V25L50 2Z" fill="#e9ecef"/><path d="M50 2L95 25V75L50 98L5 75V25L50 2Z" stroke="#0d1b2a" stroke-width="3"/><path d="M25 70 L50 30 L75 70 Z" fill="#4a4a4a"/><rect x="45" y="70" width="10" height="15" fill="#4a4a4a"/></svg>` }, 'formativo': { nombre: 'Catalizador de Ideas', svg: `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M50 2L95 25V75L50 98L5 75V25L50 2Z" fill="#fffbe6" /><path d="M50 2L95 25V75L50 98L5 75V25L50 2Z" stroke="#ee9b00" stroke-width="3"/><path d="M50 30 A 20 20 0 1 1 50 70 A 20 20 0 1 1 50 30" fill="#fefae0"/><path d="M50 30 l 0 -15 M65 35 l 10 -10 M70 50 l 15 0 M65 65 l 10 10 M50 70 l 0 15 M35 65 l -10 10 M30 50 l -15 0 M35 35 l-10 -10" stroke="#ee9b00" stroke-width="4" stroke-linecap="round"/></svg>` }, };
        function otorgarInsignia(id, nombre) { if (!estadoUsuario.insignias.includes(id)) { estadoUsuario.insignias.push(id); const badgeEl = document.getElementById(`badge-${id}`); if(badgeEl) { badgeEl.classList.add('earned'); const placeholder = document.getElementById(`badge-${id}-icon-placeholder`); if(placeholder) placeholder.innerHTML = insigniasData[id].svg; } const toast = document.getElementById('badge-toast'); document.getElementById('toast-icon').innerHTML = insigniasData[id].svg; document.getElementById('toast-text').textContent = `¡Insignia Desbloqueada: ${nombre}!`; toast.style.display = 'flex'; setTimeout(() => { toast.style.display = 'none'; }, 4000); } }
        function inyectarSVGs() { for (const [id, data] of Object.entries(insigniasData)) { const placeholder = document.getElementById(`badge-${id}-icon-placeholder`); if(placeholder) { placeholder.innerHTML = data.svg; } const badgeEl = document.getElementById(`badge-${id}`); if(badgeEl && estadoUsuario.insignias.includes(id)) { badgeEl.classList.add('earned');} } }
        function poblarReporteFinal() { /* Lógica sin cambios */ } function generarCertificadoHTML() { /* Lógica sin cambios */ return ''; } function descargarCertificado() { /* Lógica sin cambios */ }
        function adjuntarEventListeners() {
            document.querySelectorAll('.btn-next').forEach(btn => btn.addEventListener('click', navegarSiguiente));
            document.querySelectorAll('.btn-prev').forEach(btn => btn.addEventListener('click', navegarAnterior));
            document.getElementById('form-ingreso').addEventListener('submit', validarFormularioIngreso);
            document.getElementById('btn-guardar-cierre').addEventListener('click', debounce(() => guardarReflexiones(), 500));
            document.getElementById('btn-borrar-datos').addEventListener('click', reiniciarCurso);
            document.getElementById('btn-reiniciar-curso').addEventListener('click', reiniciarCurso);
            /* resto de listeners */
        }
        
        init(); // Iniciar la aplicación
    });

    </script>
</body>
</html>
