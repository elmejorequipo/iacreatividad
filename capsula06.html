<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IA: Creatividad Aumentada o Amenazada</title>
    
    <meta name="description" content="Cápsula educativa interactiva sobre el impacto de la Inteligencia Artificial en la creatividad, dirigida a docentes de educación superior.">
    <meta name="keywords" content="Inteligencia Artificial, IA, Creatividad, Educación, UAGRM, SAGUAPAC, Innovación Educativa, EdTech, Diseño Instruccional, e-learning">
    <meta name="author" content="Equipo de Desarrollo Web Creativo">
    <meta property="og:title" content="IA: Creatividad Aumentada o Amenazada" />
    <meta property="og:description" content="Explora el debate sobre la IA y la creatividad a través de una experiencia de aprendizaje interactiva." />
    <meta property="og:type" content="website" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>

    <style>
        /*------------------------------------*\
          #RESET & BASIC SETUP
        \*------------------------------------*/
        :root {
            --primary-color: #0d1b2a; /* Dark Blue */
            --secondary-color: #1b263b; /* Steel Blue */
            --accent-color: #415a77; /* Shadow Blue */
            --highlight-color: #00a896; /* Teal Accent */
            --light-color: #e0e1dd; /* Light Gray */
            --text-color: #f0f0f0;
            --success-color: #00a896;
            --error-color: #d90429;
            --glass-bg: rgba(27, 38, 59, 0.6);
            --font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            --border-radius: 12px;
            --shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-family);
            background-color: var(--primary-color);
            color: var(--text-color);
            line-height: 1.8;
            font-size: 16px;
        }
        
        main {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        section {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            width: 100%;
            max-width: 900px;
            padding: 80px 20px 40px;
            text-align: center;
            opacity: 0;
            animation: fadeIn 0.8s forwards;
        }

        section.active {
            display: flex;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        /*------------------------------------*\
          #TYPOGRAPHY & COMMON ELEMENTS
        \*------------------------------------*/
        h1, h2, h3, h4 {
            font-weight: 700;
            margin-bottom: 1.2rem;
            color: var(--light-color);
            text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
        }

        h1 { font-size: 3rem; }
        h2 { font-size: 2.2rem; color: var(--highlight-color); }
        h3 { font-size: 1.8rem; }
        h4 { font-size: 1.4rem; }

        p, li {
            text-align: justify;
            margin-bottom: 1rem;
            max-width: 720px;
        }

        a {
            color: var(--highlight-color);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        a:hover, a:focus {
            color: #b3f2ea;
        }

        .button {
            display: inline-block;
            background: linear-gradient(135deg, var(--highlight-color), #007a6e);
            color: white;
            padding: 15px 35px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: bold;
            font-size: 1.1rem;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 168, 150, 0.4);
            margin-top: 20px;
        }

        .button:hover, .button:focus {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 168, 150, 0.6);
        }
        
        .button-secondary {
            background: var(--accent-color);
            box-shadow: 0 4px 15px rgba(65, 90, 119, 0.4);
        }

        .button-secondary:hover, .button-secondary:focus {
            box-shadow: 0 6px 20px rgba(65, 90, 119, 0.6);
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 720px;
            margin-top: 40px;
        }

        /* Glassmorphism Card */
        .card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            border: 1px solid rgba(255, 255, 255, 0.18);
            padding: 2rem;
            margin: 1rem 0;
            width: 100%;
            max-width: 720px;
            box-shadow: var(--shadow);
        }

        /*------------------------------------*\
          #SVG STYLES & ANIMATIONS
        \*------------------------------------*/
        .animated-svg {
            width: 250px;
            height: auto;
            margin: 20px 0;
        }

        #brain-path {
            stroke-dasharray: 1500;
            stroke-dashoffset: 1500;
            animation: draw 5s ease-in-out forwards infinite alternate;
        }

        @keyframes draw {
            to {
                stroke-dashoffset: 0;
            }
        }

        .icon-svg {
            width: 80px;
            height: 80px;
            margin: 15px;
            fill: var(--highlight-color);
        }

        /*------------------------------------*\
          #FORM & INPUT STYLES
        \*------------------------------------*/
        .form-group {
            margin-bottom: 1.5rem;
            width: 100%;
            max-width: 500px;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            text-align: left;
            font-weight: bold;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 2px solid var(--accent-color);
            background-color: var(--secondary-color);
            color: var(--text-color);
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: var(--highlight-color);
        }

        .form-group .error-message {
            color: var(--error-color);
            font-size: 0.9rem;
            display: none;
            margin-top: 5px;
            text-align: left;
        }
        
        .form-group.invalid input {
            border-color: var(--error-color);
        }
        
        .form-group.invalid .error-message {
            display: block;
        }
        
        /*------------------------------------*\
          #HEADER & NAVIGATION
        \*------------------------------------*/
        header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 10px 20px;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-weight: bold;
            font-size: 1.5rem;
            color: var(--light-color);
        }

        #main-nav {
            display: flex;
            align-items: center;
        }

        #nav-menu {
            display: flex;
            list-style: none;
        }

        #nav-menu li {
            margin: 0 10px;
        }

        #nav-menu a {
            color: var(--light-color);
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        
        #nav-menu a:hover, #nav-menu a.active-nav {
            background-color: var(--highlight-color);
        }

        #hamburger-btn {
            display: none;
            cursor: pointer;
            background: none;
            border: none;
            padding: 10px;
        }
        
        #hamburger-btn .bar {
            display: block;
            width: 25px;
            height: 3px;
            margin: 5px auto;
            background-color: var(--light-color);
            transition: all 0.3s ease-in-out;
        }

        /*------------------------------------*\
          #PROGRESS BAR
        \*------------------------------------*/
        #progress-container {
            width: 100%;
            background-color: var(--accent-color);
            height: 8px;
            position: fixed;
            top: 58px; /* Adjust based on header height */
            z-index: 999;
        }
        
        #progress-bar {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, var(--highlight-color), #00d9c0);
            transition: width 0.5s ease-out;
        }
        
        #progress-text {
            text-align: center;
            margin-top: 15px;
            font-weight: bold;
        }

        /*------------------------------------*\
          #VIDEO QUIZ & MODALS
        \*------------------------------------*/
        .video-container {
            width: 100%;
            max-width: 800px;
            position: relative;
            margin: 20px 0;
            aspect-ratio: 16 / 9;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 0;
        }
        
        #video-quiz-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.7);
            align-items: center;
            justify-content: center;
        }

        #video-quiz-modal .card {
            max-width: 600px;
            animation: zoomIn 0.5s;
        }

        @keyframes zoomIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .quiz-option {
            display: block;
            background-color: var(--accent-color);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            border: 2px solid transparent;
            text-align: left;
        }

        .quiz-option:hover {
            background-color: var(--highlight-color);
            transform: scale(1.02);
        }
        
        .quiz-option.selected {
            background-color: #415a77;
            border-color: #b3f2ea;
        }
        
        .quiz-option.correct {
            background-color: var(--success-color);
            border-color: #fff;
            color: #fff;
            animation: pulse 0.5s;
        }

        .quiz-option.incorrect {
            background-color: var(--error-color);
            border-color: #fff;
            color: #fff;
            animation: shake 0.5s;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /*------------------------------------*\
          #FINAL EVALUATION
        \*------------------------------------*/
        #evaluation-timer {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--highlight-color);
            margin-bottom: 20px;
        }
        
        #evaluation-results .card {
             text-align: left;
        }
        
        /*------------------------------------*\
          #BADGE NOTIFICATION
        \*------------------------------------*/
        #badge-modal {
            display: none;
            position: fixed;
            z-index: 3000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            align-items: center;
            justify-content: center;
        }
        
        .badge-content {
            background: var(--secondary-color);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            animation: zoomIn 0.5s;
            border: 2px solid var(--highlight-color);
            box-shadow: 0 0 40px rgba(0, 168, 150, 0.5);
        }
        
        .badge-content svg {
            width: 150px;
            height: 150px;
            margin-bottom: 20px;
        }

        /*------------------------------------*\
          #CERTIFICATE
        \*------------------------------------*/
        #certificate-wrapper {
            width: 800px;
            height: 565px;
            padding: 40px;
            border: 10px solid var(--accent-color);
            background-color: var(--light-color);
            color: var(--primary-color);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative; /* For pseudo-elements */
            box-shadow: var(--shadow);
        }
        #certificate-wrapper::before, #certificate-wrapper::after {
            content: '';
            position: absolute;
            width: 50px;
            height: 50px;
            background: var(--highlight-color);
            z-index: 1;
        }
        #certificate-wrapper::before { top: -10px; left: -10px; }
        #certificate-wrapper::after { bottom: -10px; right: -10px; }
        
        .cert-header { text-align: center; }
        .cert-header h1 { color: var(--primary-color); font-size: 2.5rem; }
        .cert-header p { text-align: center; font-size: 1.2rem; }
        
        .cert-body { text-align: center; margin: 30px 0; }
        .cert-body p { text-align: center; }
        #cert-user-name {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--highlight-color);
            border-bottom: 2px solid var(--primary-color);
            display: inline-block;
            padding-bottom: 5px;
            margin: 10px 0;
        }

        .cert-footer {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }
        .cert-signature, .cert-qr { text-align: center; }
        .cert-signature p { border-top: 1px solid var(--primary-color); margin: 0; padding-top: 5px; text-align:center; }
        #cert-qrcode { margin-top: 10px; border: 2px solid var(--primary-color); padding: 5px; }

        /*------------------------------------*\
          #FLOATING BUTTONS & UTILITIES
        \*------------------------------------*/
        .floating-buttons {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 998;
        }
        .floating-btn {
            background-color: var(--highlight-color);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: transform 0.3s, background-color 0.3s;
        }
        .floating-btn:hover {
            transform: scale(1.1);
        }
        #clear-data-btn {
            background-color: var(--error-color);
        }
        .floating-btn svg {
            width: 30px;
            height: 30px;
            fill: white;
        }
        
        /*------------------------------------*\
          #RESPONSIVE DESIGN
        \*------------------------------------*/
        @media (max-width: 768px) {
            h1 { font-size: 2.5rem; }
            h2 { font-size: 1.8rem; }
            h3 { font-size: 1.5rem; }
            section { padding: 80px 15px 40px; }

            #nav-menu {
                display: none;
                flex-direction: column;
                position: absolute;
                top: 60px;
                right: 0;
                background: var(--secondary-color);
                width: 100%;
                text-align: center;
            }
            #nav-menu.active { display: flex; }
            #nav-menu li { margin: 15px 0; }
            #hamburger-btn { display: block; }
            
            .floating-buttons {
              bottom: 15px;
              right: 15px;
            }
            .floating-btn {
              width: 50px;
              height: 50px;
            }
        }
        
        @media (max-width: 480px) {
            body { font-size: 15px; }
            .button { padding: 12px 28px; font-size: 1rem; }
            .nav-buttons { flex-direction: column; gap: 15px; }
            .nav-buttons .button { width: 100%; }
        }
        
        /*------------------------------------*\
          #Print Styles for Report
        \*------------------------------------*/
        @media print {
            body * {
                visibility: hidden;
            }
            #final-report, #final-report * {
                visibility: visible;
            }
            #final-report {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                color: #000;
                background: #fff;
            }
            .button { display: none; }
        }
    </style>
</head>
<body>

    <header>
        <div class="logo">IA & Creatividad</div>
        <nav id="main-nav">
            <ul id="nav-menu">
                </ul>
            <button id="hamburger-btn" aria-label="Toggle Navigation Menu">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </button>
        </nav>
    </header>

    <div id="progress-container">
        <div id="progress-bar"></div>
    </div>
    
    <main>

        <section id="ingreso" data-title="Ingreso" class="active">
            <div class="card">
                <h2>¡Te damos la bienvenida!</h2>
                <p>Estás a punto de iniciar una exploración sobre el fascinante cruce entre la <strong>Inteligencia Artificial y la Creatividad Humana</strong>. Para personalizar tu experiencia y generar tu certificado de finalización, por favor, ingresa tus datos.</p>
                <form id="user-form" novalidate>
                    <div class="form-group">
                        <label for="fullName">Nombre Completo</label>
                        <input type="text" id="fullName" name="fullName" required>
                        <div class="error-message">Por favor, introduce tu nombre completo.</div>
                    </div>
                    <div class="form-group">
                        <label for="email">Correo Electrónico</label>
                        <input type="email" id="email" name="email" required>
                        <div class="error-message">Por favor, introduce un correo válido.</div>
                    </div>
                    <div class="form-group">
                        <label for="phone">Teléfono (Opcional)</label>
                        <input type="tel" id="phone" name="phone">
                    </div>
                    <button type="submit" class="button">Comenzar Aventura</button>
                </form>
            </div>
        </section>

        <section id="portada" data-title="Portada">
            <h1>IA: Creatividad Aumentada o Amenazada</h1>
            <svg class="animated-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="brainGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:var(--highlight-color);stop-opacity:1" />
                        <stop offset="100%" style="stop-color:var(--light-color);stop-opacity:1" />
                    </linearGradient>
                </defs>
                <path id="brain-path" fill="none" stroke="url(#brainGradient)" stroke-width="2" d="M100,20 C40,20 20,70 20,100 C20,130 40,180 100,180 C160,180 180,130 180,100 C180,70 160,20 100,20 M100,20 C100,50 80,50 80,70 S100,90 100,120 S120,150 120,130 S100,110 100,80 M50,100 C65,85 80,115 100,100 C120,85 135,115 150,100 M80,70 C70,60 60,80 70,90 M120,130 C130,140 140,120 130,110 M100,120 C90,140 110,140 100,120"/>
            </svg>
            <h3>Una cápsula educativa para explorar el futuro de la creación.</h3>
            <button class="button" onclick="app.navigateTo('introduccion')">Descubrir</button>
        </section>

        <section id="introduccion" data-title="Introducción">
            <div class="card">
                <h2>Introducción: El Dilema Creativo</h2>
                <p>¡Hola, <span class="user-name">profe</span>! En esta cápsula, nos sumergiremos en uno de los debates más relevantes de nuestra era. ¿Es la IA una herramienta que potenciará nuestra creatividad a niveles insospechados, o representa una amenaza para la originalidad y el rol del creador humano? </p>
            </div>
            
            <div class="card">
                <h3><svg aria-hidden="true" style="width:1em;height:1em;vertical-align:-0.125em;" fill="currentColor" viewBox="0 0 512 512"><path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336h24V272H216c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24H216c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-144c-17.7 0-32-14.3-32-32s14.3-32 32-32s32 14.3 32 32s-14.3 32-32 32z"/></svg> Objetivos de Aprendizaje</h3>
                <p>Al finalizar esta experiencia, serás capaz de:</p>
                <ul style="list-style-position: inside; text-align: left;">
                    <li><strong>Analizar</strong> el impacto de las herramientas de IA generativa en los procesos creativos tradicionales y educativos.</li>
                    <li><strong>Evaluar</strong> críticamente las implicaciones éticas y pedagógicas del uso de la IA en la creación de contenido por parte de los estudiantes.</li>
                    <li><strong>Diseñar</strong> nuevas estrategias de enseñanza y consignas de evaluación que integren la IA como un potenciador de la creatividad, en lugar de un sustituto del esfuerzo.</li>
                    <li><strong>Argumentar</strong> una postura informada sobre el futuro de la creatividad en un entorno académico y profesional mediado por la IA.</li>
                </ul>
            </div>
            
            <div class="card">
                <h3><svg aria-hidden="true" style="width:1em;height:1em;vertical-align:-0.125em;" fill="currentColor" viewBox="0 0 640 512"><path d="M144 0a80 80 0 1 1 0 160A80 80 0 1 1 144 0zM512 0a80 80 0 1 1 0 160A80 80 0 1 1 512 0zM0 298.7C0 239.8 47.8 192 106.7 192h42.7c15.9 0 31 3.5 44.6 9.7c-1.3 7.2-1.9 14.7-1.9 22.3c0 38.2 16.8 72.5 43.3 96c-.2 0-.4 0-.7 0H21.3C9.6 320 0 310.4 0 298.7zM405.3 192h42.7C592.2 192 640 239.8 640 298.7c0 11.8-9.6 21.3-21.3 21.3H489.9c-.2 0-.4 0-.7 0c26.5-23.5 43.3-57.8 43.3-96c0-7.6-.7-15-1.9-22.3c13.6-6.3 28.7-9.7 44.6-9.7zM320 256c-61.9 0-112 50.1-112 112c0 8.8 7.2 16 16 16H416c8.8 0 16-7.2 16-16c0-61.9-50.1-112-112-112z"/></svg> Storytelling: "El Informe Perfecto"</h3>
                <p>Para encender la chispa de la discusión, te presentamos una escena que podría estar ocurriendo ahora mismo en cualquier pasillo universitario. Ponte cómodo, que la función está por comenzar.</p>
                <div style="text-align: left; padding: 15px; border-left: 4px solid var(--highlight-color); background: var(--secondary-color); border-radius: 8px;">
                    <p><strong>Contexto:</strong> La Universidad Autónoma Gabriel René Moreno (U.A.G.R.M.) en Santa Cruz de la Sierra. Dos profesores universitarios debaten sobre un informe estudiantil que aborda un problema local muy conocido: los cortes de agua de la cooperativa SAGUAPAC.</p>
                    <p><strong>Personajes:</strong></p>
                    <ul>
                        <li><strong>DRA. ELENA VARGAS (60s):</strong> Prestigiosa catedrática de la Facultad de Sociología, conocida por su enfoque en el trabajo de campo y la investigación urbana.</li>
                        <li><strong>DR. MATEO RÍOS (30s):</strong> Profesor de la Facultad de Comunicación y Medios Digitales, un colega curioso y siempre al día con las nuevas tecnologías.</li>
                    </ul>
                    <hr style="margin: 15px 0; border-color: var(--accent-color);">
                    <p><strong>INT. OFICINA DE LA DRA. VARGAS - TARDE</strong></p>
                    <p>La oficina de Elena está llena de libros sobre teoría social. Sostiene un informe con una expresión de absoluto desconcierto. El DR. MATEO RÍOS asoma la cabeza.</p>
                    <p><strong>MATEO:</strong> ¿Doctora, buen día? Vengo en mi peregrinaje habitual por un poco de ese café suyo. Le juro que es lo único verdaderamente análogo y funcional que nos queda...</p>
                    <p><strong>ELENA:</strong> Sírvasle con confianza, Doctor. Pero le advierto que mi paciencia está más intermitente que el servicio de agua en la ciudad.</p>
                    <p>Mateo suelta una carcajada mientras se sirve.</p>
                    <p><strong>MATEO:</strong> No me diga más. A estas alturas, creerle a SAGUAPAC es como creerle a mi ex. Dice que cortará y al final no corta nada, y me deja con los baldes llenos.</p>
                    <p>Elena esboza una media sonrisa, un gesto de complicidad ante la broma tan cruceña.</p>
                    <p><strong>ELENA:</strong> Ojalá mi problema fuera tan sencillo. Mire. (Señala el informe: "Análisis del Impacto Socioeconómico de los Cortes de SAGUAPAC"). Es de Javier. Un estudiante de primer año. Se supone que debía hacer un análisis cualitativo, entrevistas... Y el informe es perfecto.</p>
                    <p><strong>MATEO:</strong> ¿Perfecto es malo ahora? Pensé que eso era lo que buscábamos.</p>
                    <p><strong>ELENA:</strong> (Niega) Es una perfección imposible. La redacción es impecable. El análisis cruza datos que requeriría semanas de trabajo. Y los testimonios... son demasiado perfectos. Cita a una "madre de familia" que habla como un libro de economía. Son arquetipos, no personas. Esto no es trabajo de campo. Es una simulación. Es una IA.</p>
                    <p><strong>MATEO:</strong> (Asiente lentamente) Ya veo. El fantasma en la máquina.</p>
                    <p><strong>ELENA:</strong> ¡Exacto! ¡El estudiante no ha pisado la calle! La sociología se hace con los pies en el barro. Mi primer impulso es anular el trabajo por fraude académico.</p>
                    <p><strong>MATEO:</strong> Entiendo su dilema. Pero, ¿me permite ver la consigna que les dio?</p>
                    <p>Elena, extrañada, le entrega la hoja. Mateo la lee con atención.</p>
                    <p><strong>MATEO:</strong> "Realizar un informe de impacto socioeconómico... incluyendo análisis de datos y testimonios...". Doctora... con el debido respeto, la consigna describe perfectamente la tarea en la que una IA es experta. La máquina hizo exactamente lo que se le pidió.</p>
                    <p><strong>ELENA:</strong> ¿Me está diciendo que la culpa es mía?</p>
                    <p><strong>MATEO:</strong> La responsabilidad es compartida. El paradigma cambió. Quizás el estudiante no fue al campo, es cierto. Pero, ¿y si pasó diez horas enseñándole a la IA qué es un "vecino del D-8" o cómo habla una "comerciante de mercado"? Es una especie de... etnografía digital.</p>
                    <p>Elena lo mira, sus defensas intelectuales empiezan a tambalearse.</p>
                    <p><strong>MATEO:</strong> En vez de anularlo, ¿por qué no lo cita y le pide que le defienda su metodología? Que le muestre sus prompts. Que le argumente por qué su simulación es una representación válida de la realidad social. Quizás nos sorprenda.</p>
                    <p>Elena mira el informe "perfecto". Ya no parece un fraude, sino un artefacto de un futuro que ha llegado sin avisar.</p>
                    <p><strong>ELENA:</strong> Entonces... si la forma de investigar la realidad está cambiando... nosotros tenemos que cambiar la forma en que la enseñamos.</p>
                    <p><strong>MATEO:</strong> Ese es el meollo del asunto. La pregunta real no es si el alumno hizo la tarea. La pregunta es... frente a un estudiante que puede simular la realidad con IA, nuestra capacidad como docentes para enseñar a investigarla... ¿está aumentada o está amenazada?</p>
                </div>
            </div>

            <div class="nav-buttons">
                <button class="button button-secondary" onclick="app.navigateTo('portada')">Anterior</button>
                <button class="button" onclick="app.navigateTo('activacion')">Siguiente</button>
            </div>
        </section>

        <section id="activacion" data-title="Activación">
            <h2>Activación de Conocimientos Previos</h2>
            <p>Antes de sumergirnos en el contenido, vamos a calentar motores. Este juego de parejas te ayudará a conectar ideas que ya tienes sobre la IA y la creatividad. ¡No te preocupes por la puntuación, el objetivo es explorar!</p>
            <div class="card" style="width:100%; max-width: 820px; min-height: 710px;">
                <iframe style="width:100%; height:690px;" allow="fullscreen; autoplay; allow-top-navigation-by-user-activation" allowfullscreen width="795" height="690" frameborder="0" src="https://es.educaplay.com/juego/24152723-juego_de_parejas_ia_y_creatividad.html"></iframe>
            </div>
            <div class="nav-buttons">
                <button class="button button-secondary" onclick="app.navigateTo('introduccion')">Anterior</button>
                <button class="button" onclick="app.navigateTo('desarrollo-practico')">Siguiente</button>
            </div>
        </section>

        <section id="desarrollo-practico" data-title="Práctica">
            <h2>Desarrollo Práctico: Una Perspectiva Experta</h2>
            <div class="card">
                <p>Reflexionemos un momento, <span class="user-name">profe</span>. Piensa en la historia de Elena y Mateo. ¿Has vivido una situación similar? ¿Alguna vez un trabajo te pareció "demasiado bueno" para ser verdad? ¿Cómo crees que nuestras consignas actuales, sin querer, podrían estar invitando a los estudiantes a usar la IA como un atajo en lugar de una herramienta de aprendizaje?</p>
                <p>Estas preguntas son el corazón de nuestro dilema. Ahora, te invitamos a ver una charla de un experto en animación, quien comparte su visión sobre el proceso creativo en la era de la IA. Presta mucha atención, porque durante el video, pausaremos en momentos clave para plantearte algunas preguntas. ¡No podrás continuar si no respondes correctamente!</p>
            </div>
            
            <div class="video-container">
                <iframe id="video-player" width="560" height="315" src="https://www.youtube.com/embed/a8g360bLq-Y?enablejsapi=1&origin=https://null.jsbin.com" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </div>
             <p id="video-instructions">Haz clic en el video para empezar. Se pausará automáticamente en puntos clave.</p>

            <div class="nav-buttons">
                <button class="button button-secondary" onclick="app.navigateTo('activacion')">Anterior</button>
                <button class="button" onclick="app.navigateTo('desarrollo-teorico')">Siguiente</button>
            </div>
        </section>

        <div id="video-quiz-modal" style="display: none;">
            <div class="card">
                <h3 id="video-quiz-question"></h3>
                <div id="video-quiz-options"></div>
                <p id="video-quiz-feedback" style="display:none; font-weight: bold; margin-top: 15px;"></p>
                <button id="video-quiz-submit" class="button" style="margin-top: 20px;">Responder</button>
            </div>
        </div>

        <section id="desarrollo-teorico" data-title="Teoría">
            <h2>Desarrollo Teórico y Conceptual</h2>
            <p>Ahora que hemos reflexionado y escuchado a un experto, es hora de profundizar en los conceptos clave que definen la relación entre la IA y la creatividad.</p>

            <div class="card">
                <h3>Tema 1: Desmitificando la "Creatividad" de la IA</h3>
                <p>A menudo escuchamos que la IA "crea" imágenes, textos o música. Sin embargo, es fundamental entender que el proceso de la IA no es análogo a la creatividad humana. Los modelos actuales de IA generativa, como los grandes modelos de lenguaje (LLM) o los modelos de difusión (para imágenes), operan bajo un principio de <strong>reconocimiento y recombinación de patrones</strong> a una escala masiva.</p>
                <p>Imagina que has leído cada libro de la Biblioteca del Congreso. No "entiendes" las historias en un sentido humano, pero eres un experto en qué palabra es más probable que siga a otra. La IA funciona de manera similar: no "sabe" qué es un gato, pero ha analizado millones de imágenes etiquetadas como "gato" y puede generar una nueva combinación de píxeles que estadísticamente se parece a un gato. Es <strong>mimesis algorítmica</strong>, no cognición.</p>
                <p><strong>Ejemplo real:</strong> Cuando un artista usa Midjourney para crear una imagen, no le dice "siente tristeza y píntala". Le da un <em>prompt</em> detallado: "un robot solitario sentado bajo la lluvia en una calle de neón, estilo ciberpunk, cinematográfico, colores fríos". La IA no interpreta la emoción, sino que cruza los patrones asociados a cada una de esas palabras clave para generar el resultado.</p>
                
                <h4>Preguntas de Comprensión:</h4>
                <ol style="text-align:left; padding-left:20px;">
                    <li>¿Cuál es la diferencia fundamental entre la creatividad de la IA y la humana según el texto?</li>
                    <li>¿Qué significa el término "mimesis algorítmica"?</li>
                    <li>¿Por qué el "prompt" es tan crucial al interactuar con una IA generativa?</li>
                </ol>
                <h4>Pregunta de Aplicación:</h4>
                <p style="text-align:left;">Describe cómo rediseñarías una tarea tradicional de "escribir un ensayo sobre la Revolución Francesa" para que los estudiantes usen la IA como herramienta de investigación (para encontrar patrones de datos, por ejemplo) en lugar de usarla para escribir el ensayo completo.</p>
                
                <hr style="margin:20px 0; border-color: var(--accent-color);">
                <p style="font-size:0.9rem; text-align:left;"><strong>Fuente:</strong> Boden, M. A. (2004). <em>The Creative Mind: Myths and Mechanisms</em>. Routledge. <a href="https://www.routledge.com/The-Creative-Mind-Myths-and-Mechanisms/Boden/p/book/9780415314534" target="_blank">[Enlace]</a></p>
            </div>

            <div class="card">
                <h3>Tema 2: El Docente como "Curador de Intenciones" y "Arquitecto de Consignas"</h3>
                <p>Si la IA se encarga de la generación masiva de "respuestas" (como decía Picasso en el video), el rol del humano, y específicamente del docente, se desplaza hacia esferas de mayor orden cognitivo. El docente del futuro es menos un transmisor de información y más un <strong>curador de intenciones</strong> y un <strong>arquitecto de consignas</strong>.</p>
                <ul>
                    <li><strong>Curador de Intenciones:</strong> Ayudar al estudiante a formular la <em>pregunta correcta</em>. En un mundo de respuestas infinitas, el valor reside en la pregunta única, perspicaz y bien definida. El docente guía al estudiante a través del "por qué" y el "para qué" de su investigación, asegurando que la intención sea clara antes de acudir a cualquier herramienta.</li>
                    <li><strong>Arquitecto de Consignas:</strong> Diseñar tareas que sean "a prueba de IA" o, mejor aún, que "requieran IA". Esto implica dejar de pedir resúmenes de información fácilmente accesible y empezar a solicitar tareas que exijan pensamiento crítico, síntesis personal, aplicación en contextos novedosos y, sobre todo, la defensa de una metodología.</li>
                </ul>
                <p><strong>Caso práctico:</strong> En lugar de "Hagan un informe sobre el cambio climático", la consigna se transforma en: "Utilicen una IA para generar tres escenarios futuros (utópico, distópico, realista) sobre el impacto del cambio climático en Santa Cruz de la Sierra para el 2050. Luego, escriban un ensayo crítico donde evalúen los sesgos de la IA en cada escenario, contrasten los datos con fuentes académicas locales y propongan una cuarta visión personal y fundamentada".</p>

                <h4>Preguntas de Comprensión:</h4>
                <ol style="text-align:left; padding-left:20px;">
                    <li>¿Qué dos nuevos roles se proponen para el docente en la era de la IA?</li>
                    <li>¿Por qué la formulación de preguntas se vuelve más importante que la búsqueda de respuestas?</li>
                    <li>¿Cuál es la diferencia entre una tarea "a prueba de IA" y una que "requiere IA"?</li>
                </ol>
                <h4>Pregunta de Aplicación:</h4>
                <p style="text-align:left;">Toma una evaluación que aplicas actualmente en tu materia y rediséñala bajo el modelo del "arquitecto de consignas", especificando qué parte haría el estudiante con IA y qué parte requeriría su análisis crítico e individual.</p>
                
                <hr style="margin:20px 0; border-color: var(--accent-color);">
                <p style="font-size:0.9rem; text-align:left;"><strong>Bibliografía:</strong> Siemens, G. (2005). Connectivism: A Learning Theory for the Digital Age. <em>International Journal of Instructional Technology and Distance Learning, 2</em>(1). <a href="http://www.itdl.org/Journal/Jan_05/article01.htm" target="_blank">[Enlace]</a></p>
            </div>
            
            <div class="nav-buttons">
                <button class="button button-secondary" onclick="app.navigateTo('desarrollo-practico')">Anterior</button>
                <button class="button" onclick="app.navigateTo('evaluacion-formativa')">Siguiente</button>
            </div>
        </section>

        <section id="evaluacion-formativa" data-title="Formativa">
            <h2>Evaluación Formativa: ¡A Jugar!</h2>
            <p>Has procesado bastante información, <span class="user-name">colega</span>. Es hora de una pausa activa para consolidar lo aprendido de una manera divertida. Este quiz no tiene impacto en tu calificación final, ¡así que relájate y pon a prueba tus nuevos conocimientos!</p>
            <div class="card" style="width:100%;display:flex;flex-direction:column;gap:8px;min-height:635px;">
                <iframe src="https://quizizz.com/embed/quiz/665f8019b81b21c586104192" title="IA y Creatividad - Quizizz" style="flex:1;" frameBorder="0" allowfullscreen></iframe>
            </div>

            <div class="nav-buttons">
                <button class="button button-secondary" onclick="app.navigateTo('desarrollo-teorico')">Anterior</button>
                <button class="button" onclick="app.navigateTo('evaluacion')">Siguiente</button>
            </div>
        </section>

        <section id="evaluacion" data-title="Evaluación">
            <h2>Evaluación Final: El Desafío</h2>
            <div id="evaluation-intro">
                <p>Este es el momento de demostrar lo que has aprendido. Tienes <strong>30 minutos</strong> y un máximo de <strong>3 intentos</strong> para completar este test. Necesitas un <strong>70%</strong> para aprobar y obtener tu certificado.</p>
                <p>¡Mucha suerte, <span class="user-name">crack</span>! Sabemos que lo harás genial.</p>
                <button id="start-evaluation-btn" class="button">Comenzar Evaluación</button>
            </div>
            
            <div id="evaluation-quiz" style="display:none;">
                <div id="evaluation-timer">30:00</div>
                <div class="card" id="evaluation-question-container">
                    </div>
                <button id="submit-evaluation-btn" class="button">Finalizar y Calificar</button>
            </div>

            <div id="evaluation-results" style="display:none;">
                <div class="card">
                    <h3>Resultados de la Evaluación</h3>
                    <p><strong>Puntaje Obtenido:</strong> <span id="final-score"></span>%</p>
                    <p><strong>Estado:</strong> <span id="final-status"></span></p>
                    <p><strong>Intentos restantes:</strong> <span id="attempts-left"></span></p>
                    <div id="results-feedback"></div>
                    <div id="evaluation-buttons" style="margin-top: 20px;">
                        <button id="retry-evaluation-btn" class="button button-secondary" style="display:none;">Intentar de Nuevo</button>
                        <button id="continue-to-synthesis-btn" class="button" style="display:none;" onclick="app.navigateTo('sintesis')">Continuar</button>
                    </div>
                </div>
            </div>

            <div class="nav-buttons">
                <button class="button button-secondary" onclick="app.navigateTo('evaluacion-formativa')">Anterior</button>
                <button id="next-from-eval" class="button" onclick="app.navigateTo('sintesis')" disabled>Siguiente</button>
            </div>
        </section>

        <section id="sintesis" data-title="Síntesis">
            <h2>Síntesis: Las Ideas Clave</h2>
            <p>¡Felicidades por llegar hasta aquí! Recapitulemos las ideas más importantes de nuestro viaje.</p>
            <div class="card">
                <h3>Ideas Fuerza</h3>
                <ol style="text-align:left; list-style-type:decimal; padding-left: 20px;">
                    <li><strong>La IA no crea, recombina:</strong> La creatividad de la IA es una proeza de reconocimiento de patrones y recombinación (mimesis algorítmica), no de entendimiento o intención como la humana.</li>
                    <li><strong>El valor se desplaza a la pregunta:</strong> En un mundo de respuestas instantáneas, la habilidad humana más valiosa es la capacidad de formular preguntas profundas, originales y bien definidas.</li>
                    <li><strong>El rol docente evoluciona:</strong> Debemos pasar de ser meros transmisores de contenido a ser "arquitectos de consignas" y "curadores de intenciones", diseñando experiencias de aprendizaje que usen la IA para potenciar el pensamiento crítico.</li>
                    <li><strong>La autenticidad es el nuevo premium:</strong> Frente a un mar de contenido generado por IA, la destreza, la visión personal y la originalidad humana se volverán cada vez más valiosas y buscadas.</li>
                </ol>
            </div>
            
            <div class="card">
                <h3>Infografía Resumen</h3>
                <p>Para una vista más visual de estos conceptos, hemos preparado una infografía. Haz clic en el botón para explorarla.</p>
                <a href="https://elmejorequipo.github.io/iacreatividad/infografia.html" target="_blank" class="button">Ver Infografía</a>
            </div>
            
            <div class="card">
                <h3>Podcast: Para Seguir Reflexionando</h3>
                <p>Si prefieres el formato audio, te dejamos este podcast que profundiza en el debate. ¡Ideal para escuchar mientras tomas un café!</p>
                <iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/2107792848&color=%230066cc&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe><div style="font-size: 10px; color: #cccccc;line-break: anywhere;word-break: normal;overflow: hidden;white-space: nowrap;text-overflow: ellipsis; font-family: Interstate,Lucida Grande,Lucida Sans Unicode,Lucida Sans,Garuda,Verdana,Tahoma,sans-serif;font-weight: 100;"><a href="https://soundcloud.com/el-mejor-equipo-282759177" title="El Mejor Equipo" target="_blank" style="color: #cccccc; text-decoration: none;">El Mejor Equipo</a> · <a href="https://soundcloud.com/el-mejor-equipo-282759177/creatividad-humana-y-la-ia-amiga-o-enemiga" title="Creatividad humana y la IA ¿Amiga o enemiga?" target="_blank" style="color: #cccccc; text-decoration: none;">Creatividad humana y la IA ¿Amiga o enemiga?</a></div>
            </div>

            <div class="nav-buttons">
                <button class="button button-secondary" onclick="app.navigateTo('evaluacion')">Anterior</button>
                <button class="button" onclick="app.navigateTo('cierre')">Siguiente</button>
            </div>
        </section>

        <section id="cierre" data-title="Cierre">
            <h2>Cierre y Preguntas Metacognitivas</h2>
            <p>El aprendizaje más profundo ocurre cuando reflexionamos sobre lo que hemos aprendido y cómo podemos aplicarlo. Tómate un momento para responder estas preguntas.</p>
            
            <div id="metacognition-form">
                <div class="card">
                    <label for="meta-q1" style="font-weight:bold; text-align:left; display:block;">1. ¿Cuál es el cambio más significativo que planeas hacer en una de tus clases o evaluaciones después de completar esta cápsula?</label>
                    <textarea id="meta-q1" rows="4" style="width:100%; margin-top:10px; padding:10px; background:var(--primary-color); color:var(--text-color); border-radius:8px; border:1px solid var(--accent-color);"></textarea>
                </div>
                <div class="card">
                    <label for="meta-q2" style="font-weight:bold; text-align:left; display:block;">2. ¿Qué nueva pregunta te surge sobre la IA y la educación que no tenías antes de iniciar este recorrido?</label>
                    <textarea id="meta-q2" rows="4" style="width:100%; margin-top:10px; padding:10px; background:var(--primary-color); color:var(--text-color); border-radius:8px; border:1px solid var(--accent-color);"></textarea>
                </div>
                <div class="card">
                    <label for="meta-q3" style="font-weight:bold; text-align:left; display:block;">3. Imagina que tienes que explicarle a un colega escéptico por qué no debe prohibir la IA, sino integrarla. ¿Cuál sería tu argumento principal, en 30 segundos?</label>
                    <textarea id="meta-q3" rows="4" style="width:100%; margin-top:10px; padding:10px; background:var(--primary-color); color:var(--text-color); border-radius:8px; border:1px solid var(--accent-color);"></textarea>
                </div>
            </div>
            <button class="button" onclick="app.saveMetacognition()">Guardar Respuestas</button>
            <p id="meta-saved-feedback" style="display:none; color: var(--success-color); font-weight: bold;">¡Respuestas guardadas para tu reporte!</p>
            
            <div class="card">
                <h3>Rúbrica Analítica para Autoevaluación</h3>
                <p>Usa esta rúbrica para evaluar la profundidad de tus propias reflexiones. Está basada en el nivel "Crear" de la Taxonomía de Bloom.</p>
                <div style="overflow-x:auto;">
                    <table style="width:100%; border-collapse: collapse; margin-top:20px; color:var(--text-color);">
                        <thead style="background:var(--accent-color);">
                            <tr>
                                <th style="padding:10px; border:1px solid var(--primary-color);">Criterio</th>
                                <th style="padding:10px; border:1px solid var(--primary-color);">En Desarrollo (1)</th>
                                <th style="padding:10px; border:1px solid var(--primary-color);">Desarrollo Aceptable (2)</th>
                                <th style="padding:10px; border:1px solid var(--primary-color);">Desarrollo Óptimo (3)</th>
                                <th style="padding:10px; border:1px solid var(--primary-color);">Desarrollo Pleno (4)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background:var(--secondary-color);">
                                <td style="padding:10px; border:1px solid var(--primary-color); font-weight:bold;">Originalidad y Síntesis</td>
                                <td style="padding:10px; border:1px solid var(--primary-color);">Repite ideas de la cápsula sin elaboración personal.</td>
                                <td style="padding:10px; border:1px solid var(--primary-color);">Combina conceptos de la cápsula con experiencias propias de forma básica.</td>
                                <td style="padding:10px; border:1px solid var(--primary-color);">Genera una nueva perspectiva o plan de acción concreto que integra claramente la teoría con su práctica docente.</td>
                                <td style="padding:10px; border:1px solid var(--primary-color);">Propone una idea innovadora o un modelo de aplicación original que va más allá de lo presentado, mostrando una síntesis única.</td>
                            </tr>
                            <tr style="background:var(--secondary-color);">
                                <td style="padding:10px; border:1px solid var(--primary-color); font-weight:bold;">Profundidad de la Reflexión</td>
                                <td style="padding:10px; border:1px solid var(--primary-color);">Las respuestas son superficiales y no demuestran un cuestionamiento profundo.</td>
                                <td style="padding:10px; border:1px solid var(--primary-color);">Considera las implicaciones de la IA en su contexto, pero sin explorar matices o complejidades.</td>
                                <td style="padding:10px; border:1px solid var(--primary-color);">Analiza críticamente su propio rol y prácticas, identificando dilemas y oportunidades específicas.</td>
                                <td style="padding:10px; border:1px solid var(--primary-color);">Cuestiona los supuestos subyacentes (propios y del sistema educativo) y formula nuevas preguntas que abren futuras líneas de investigación.</td>
                            </tr>
                            <tr style="background:var(--secondary-color);">
                                <td style="padding:10px; border:1px solid var(--primary-color); font-weight:bold;">Viabilidad y Planificación</td>
                                <td style="padding:10px; border:1px solid var(--primary-color);">Menciona un cambio deseado pero sin un plan claro para su implementación.</td>
                                <td style="padding:10px; border:1px solid var(--primary-color);">Esboza un plan de acción general, pero con pasos poco definidos.</td>
                                <td style="padding:10px; border:1px solid var(--primary-color);">Diseña un plan de acción específico, realista y aplicable a su entorno profesional.</td>
                                <td style="padding:10px; border:1px solid var(--primary-color);">Elabora un plan de acción detallado, anticipando posibles obstáculos y proponiendo métricas para evaluar su éxito.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>


            <div class="nav-buttons">
                <button class="button button-secondary" onclick="app.navigateTo('sintesis')">Anterior</button>
                <button class="button" onclick="app.navigateTo('certificado')">Ir a mi Certificado</button>
            </div>
        </section>

        <section id="certificado" data-title="Certificado">
            <div id="certificate-content">
                <h2>Tu Certificado de Finalización</h2>
                <div id="certificate-placeholder">
                    </div>
                <button id="download-cert-btn" class="button">Descargar Certificado (PDF)</button>
            </div>
             <div id="certificate-locked" style="display:none;">
                <h2>Certificado Bloqueado</h2>
                <p>Debes aprobar la evaluación final con un 70% o más para generar tu certificado.</p>
                <button class="button" onclick="app.navigateTo('evaluacion')">Volver a la Evaluación</button>
            </div>
            
             <div class="nav-buttons">
                <button class="button button-secondary" onclick="app.navigateTo('cierre')">Anterior</button>
                <button class="button" onclick="app.restartCourse()">Reiniciar Curso</button>
            </div>
        </section>

        <div id="badge-modal">
            <div class="badge-content">
                <h2 id="badge-title">¡Insignia Desbloqueada!</h2>
                <div id="badge-icon"></div>
                <h3 id="badge-name"></h3>
                <p id="badge-description"></p>
                <button class="button" onclick="document.getElementById('badge-modal').style.display = 'none'">¡Genial!</button>
            </div>
        </div>

    </main>
    
    <div class="floating-buttons">
        <a href="https://notebooklm.google.com/notebook/c4d90a4e-4c2b-4526-9b60-93548a358137" target="_blank" class="floating-btn" aria-label="Abrir Chat de Apoyo en NotebookLM">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4c26.5 9.6 56.2 15.1 87.8 15.1c124.7 0 208-80.5 208-160s-83.3-160-208-160S48 160.5 48 240c0 32 12.4 62.8 35.7 89.2c-15.6 9.9-35.8 12.2-54.3 6.7c-12.6-3.8-25.5-1.1-36.5 6.1c-14.8 9.6-24.3 25.5-24.3 42.6C8 446.8 21.2 464 38.8 464H215.2c10 0 19.3-5.8 23.7-15.5C241.1 446 241.6 440.1 241 434.4c-2.3-22.9-15.3-38.9-30.1-48.4c-1.5-1-2.9-2.1-4.4-3.1c-4.8-3.2-10.5-4.8-16.4-4.8c-27.9 0-46.7-14.7-52.6-21.9c-2.2-2.7-2.9-6.4-1.7-9.5c1.2-3.1 4.1-5.1 7.3-5.1H123.6z"/></svg>
        </a>
        <button id="clear-data-btn" class="floating-btn" aria-label="Borrar todos los datos y reiniciar">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"/></svg>
        </button>
    </div>

    <script>
    class EducationalCapsule {
        constructor() {
            this.state = {
                user: null,
                currentSection: 'ingreso',
                progress: {},
                evaluation: {
                    attempts: 3,
                    score: null,
                    timer: 1800, // 30 minutes in seconds
                    interval: null,
                    passed: false
                },
                metacognition: {},
                badges: []
            };

            this.sections = [];
            this.videoQuizData = [
                { time: 104, // 1:44 - On the three steps
                  question: "Según el ponente, ¿cuál es el primer y más importante paso del proceso creativo, exclusivo de los humanos?",
                  options: ["Documentarse exhaustivamente.", "Encontrar la respuesta correcta.", "Hacerse las preguntas correctas.", "Tener una idea genial."],
                  correct: 2,
                  answered: false },
                { time: 275, // 4:35 - On photography liberating painting
                  question: "El ponente usa la invención de la fotografía como una analogía para explicar que:",
                  options: ["La nueva tecnología siempre destruye a la antigua.", "La pintura se volvió obsoleta.", "Liberar a un arte de su 'obligación' (copiar la realidad) puede impulsar nuevas formas de creatividad.", "Cualquiera puede ser un artista con la herramienta correcta."],
                  correct: 2,
                  answered: false },
                { time: 375, // 6:15 - What humans bring
                  question: "De las siguientes, ¿cuál NO es una cualidad que el ponente atribuye a los humanos y que las máquinas no poseen?",
                  options: ["Originalidad.", "Velocidad y eficiencia.", "Destreza y criterio.", "Visión y un objetivo final."],
                  correct: 1,
                  answered: false },
                { time: 470, // 7:50 - On hard work
                  question: "¿Cuál es la conclusión principal del ponente para el estudiante que preguntó si debía seguir dibujando?",
                  options: ["Que no vale la pena porque la IA lo hará mejor.", "Que debe enfocarse solo en usar herramientas de IA.", "Que sí merece la pena, pero requerirá mucho trabajo duro y formación, independientemente de si usa IA o no.", "Que debería cambiar de vocación a algo menos amenazado por la IA."],
                  correct: 2,
                  answered: false }
            ];
            
            this.evaluationQuestions = [
                {
                    question: "Según la historia de la Dra. Vargas y el Dr. Ríos, ¿cuál es el principal cambio de paradigma que la IA introduce en la evaluación académica?",
                    options: [
                        "Los estudiantes ya no necesitan investigar en absoluto.",
                        "El fraude académico se vuelve imposible de detectar.",
                        "La evaluación debe centrarse más en la metodología y la defensa del proceso (incluido el uso de IA) que solo en el producto final.",
                        "Los profesores deben aprender a programar en IA."
                    ],
                    correct: 2
                },
                {
                    question: "El concepto de 'mimesis algorítmica' discutido en la sección teórica sugiere que la IA...",
                    options: [
                        "Comprende verdaderamente los conceptos que genera.",
                        "Crea de forma espontánea y original desde cero.",
                        "Es excelente para imitar y recombinar patrones existentes sin una comprensión real.",
                        "Es una forma de conciencia digital."
                    ],
                    correct: 2
                },
                {
                    question: "Un 'arquitecto de consignas' es un docente que diseña tareas que...",
                    options: [
                        "Prohíben estrictamente cualquier uso de la tecnología.",
                        "Son tan fáciles que la IA no es necesaria.",
                        "Solo pueden ser resueltas por una IA avanzada.",
                        "Integran la IA como una herramienta obligatoria para luego exigir un análisis crítico y una síntesis personal por parte del estudiante."
                    ],
                    correct: 3
                },
                {
                    question: "En el video, la invención de la fotografía se presenta como un evento que, análogamente a la IA, no destruyó la pintura sino que...",
                    options: [
                        "Hizo que todos los pintores se volvieran fotógrafos.",
                        "La liberó de la obligación de copiar la realidad, dando paso a movimientos como el cubismo y el expresionismo.",
                        "Demostró que la pintura era un arte superior.",
                        "No tuvo ningún impacto real en el mundo del arte."
                    ],
                    correct: 1
                },
                {
                    question: "De acuerdo con los tres elementos que el humano aporta y la máquina no (según el video), ¿cuál de ellos permite al creador juzgar la calidad de las respuestas que ofrece la IA?",
                    options: [
                        "La visión.",
                        "La originalidad.",
                        "La velocidad.",
                        "La destreza, que otorga criterio."
                    ],
                    correct: 3
                },
                {
                    question: "El objetivo principal de esta cápsula educativa es que los docentes...",
                    options: [
                        "Aprendan a usar Midjourney y ChatGPT a nivel experto.",
                        "Desarrollen una postura crítica y constructiva para rediseñar sus prácticas pedagógicas en la era de la IA.",
                        "Concluyan que la IA es una amenaza que debe ser prohibida en las aulas.",
                        "Memoricen las fechas clave en el desarrollo de la inteligencia artificial."
                    ],
                    correct: 1
                }
            ];
            this.videoTimer = null;
        }

        init() {
            document.addEventListener('DOMContentLoaded', () => {
                this.cacheDOMElements();
                this.populateSections();
                this.populateNav();
                this.loadState();
                this.setupEventListeners();
                this.navigateTo(this.state.currentSection);
                this.updateUI();
                
                // Special setup for video quiz
                const videoPlayer = document.getElementById('video-player');
                if (videoPlayer) {
                    this.videoTimer = setInterval(() => this.checkVideoTime(), 1000);
                }
            });
        }
        
        cacheDOMElements() {
            this.dom = {
                main: document.querySelector('main'),
                sections: document.querySelectorAll('main section'),
                userForm: document.getElementById('user-form'),
                fullNameInput: document.getElementById('fullName'),
                emailInput: document.getElementById('email'),
                userNameSpans: document.querySelectorAll('.user-name'),
                progressBar: document.getElementById('progress-bar'),
                navMenu: document.getElementById('nav-menu'),
                hamburgerBtn: document.getElementById('hamburger-btn'),
                clearDataBtn: document.getElementById('clear-data-btn'),
                videoQuizModal: document.getElementById('video-quiz-modal'),
                videoQuizQuestion: document.getElementById('video-quiz-question'),
                videoQuizOptions: document.getElementById('video-quiz-options'),
                videoQuizSubmit: document.getElementById('video-quiz-submit'),
                videoQuizFeedback: document.getElementById('video-quiz-feedback'),
                // Evaluation elements
                evaluationIntro: document.getElementById('evaluation-intro'),
                startEvaluationBtn: document.getElementById('start-evaluation-btn'),
                evaluationQuiz: document.getElementById('evaluation-quiz'),
                evaluationTimer: document.getElementById('evaluation-timer'),
                evaluationContainer: document.getElementById('evaluation-question-container'),
                submitEvaluationBtn: document.getElementById('submit-evaluation-btn'),
                evaluationResults: document.getElementById('evaluation-results'),
                finalScore: document.getElementById('final-score'),
                finalStatus: document.getElementById('final-status'),
                attemptsLeft: document.getElementById('attempts-left'),
                resultsFeedback: document.getElementById('results-feedback'),
                retryEvaluationBtn: document.getElementById('retry-evaluation-btn'),
                continueToSynthesisBtn: document.getElementById('continue-to-synthesis-btn'),
                nextFromEvalBtn: document.getElementById('next-from-eval'),
                // Certificate
                certificateContent: document.getElementById('certificate-content'),
                certificateLocked: document.getElementById('certificate-locked'),
                certificatePlaceholder: document.getElementById('certificate-placeholder'),
                downloadCertBtn: document.getElementById('download-cert-btn')
            };
        }

        setupEventListeners() {
            this.dom.userForm.addEventListener('submit', (e) => this.handleUserFormSubmit(e));
            this.dom.hamburgerBtn.addEventListener('click', () => this.toggleMobileMenu());
            this.dom.clearDataBtn.addEventListener('click', () => this.restartCourse());
            this.dom.videoQuizSubmit.addEventListener('click', () => this.checkVideoQuizAnswer());
            this.dom.startEvaluationBtn.addEventListener('click', () => this.startEvaluation());
            this.dom.submitEvaluationBtn.addEventListener('click', () => this.submitEvaluation());
            this.dom.retryEvaluationBtn.addEventListener('click', () => this.startEvaluation());
            this.dom.downloadCertBtn.addEventListener('click', () => this.downloadCertificate());
        }

        saveState() {
            localStorage.setItem('eduCapsuleState', JSON.stringify(this.state));
        }

        loadState() {
            const savedState = localStorage.getItem('eduCapsuleState');
            if (savedState) {
                this.state = JSON.parse(savedState);
                if(this.state.user){
                    this.updateUserNames(this.state.user.name);
                }
            }
        }
        
        restartCourse() {
            if(confirm('¿Estás seguro de que quieres borrar todos tus datos y reiniciar el curso? Esta acción no se puede deshacer.')) {
                localStorage.removeItem('eduCapsuleState');
                // Clear intervals if any
                if(this.state.evaluation.interval) clearInterval(this.state.evaluation.interval);
                // Reset state object to its initial form
                this.state = {
                    user: null, currentSection: 'ingreso', progress: {}, 
                    evaluation: { attempts: 3, score: null, timer: 1800, interval: null, passed: false },
                    metacognition: {}, badges: []
                };
                window.location.reload();
            }
        }

        populateSections() {
            this.dom.sections.forEach(section => {
                this.sections.push({ id: section.id, title: section.dataset.title });
            });
        }
        
        populateNav() {
            this.dom.navMenu.innerHTML = '';
            this.sections.forEach(section => {
                const li = document.createElement('li');
                const a = document.createElement('a');
                a.href = `#${section.id}`;
                a.textContent = section.title;
                a.onclick = (e) => {
                    e.preventDefault();
                    if (!this.isSectionLocked(section.id)) {
                        this.navigateTo(section.id);
                        if(window.innerWidth <= 768) this.toggleMobileMenu();
                    } else {
                        alert("Completa las secciones anteriores para acceder a esta.");
                    }
                };
                li.appendChild(a);
                this.dom.navMenu.appendChild(li);
            });
        }
        
        toggleMobileMenu() {
            this.dom.navMenu.classList.toggle('active');
        }

        handleUserFormSubmit(e) {
            e.preventDefault();
            const fullName = this.dom.fullNameInput.value.trim();
            const email = this.dom.emailInput.value.trim();
            let isValid = true;
            
            // Validation
            if (fullName === '') {
                this.dom.fullNameInput.parentElement.classList.add('invalid');
                isValid = false;
            } else {
                this.dom.fullNameInput.parentElement.classList.remove('invalid');
            }
            
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (email === '' || !emailRegex.test(email)) {
                this.dom.emailInput.parentElement.classList.add('invalid');
                isValid = false;
            } else {
                this.dom.emailInput.parentElement.classList.remove('invalid');
            }

            if (isValid) {
                this.state.user = { 
                    name: fullName, 
                    email: email, 
                    phone: document.getElementById('phone').value.trim() 
                };
                this.updateUserNames(fullName);
                this.navigateTo('portada');
                this.saveState();
            }
        }
        
        updateUserNames(name) {
             const firstName = name.split(' ')[0];
             this.dom.userNameSpans.forEach(span => span.textContent = firstName);
        }

        navigateTo(sectionId) {
            if (this.isSectionLocked(sectionId)) {
                 alert("Por favor, completa los pasos anteriores para continuar.");
                 return;
            }
            
            this.dom.sections.forEach(section => {
                section.classList.remove('active');
            });
            const newSection = document.getElementById(sectionId);
            if (newSection) {
                newSection.classList.add('active');
                this.state.currentSection = sectionId;
                this.updateProgress(sectionId);
                this.updateActiveNavLink(sectionId);
                this.checkAndAwardBadge(sectionId);
                
                // Specific logic for sections
                if(sectionId === 'certificado'){
                    this.renderCertificate();
                }
                 if(sectionId === 'evaluacion'){
                    this.prepareEvaluationScreen();
                }
                
                this.saveState();
            }
        }
        
        isSectionLocked(sectionId) {
            const order = this.sections.map(s => s.id);
            const targetIndex = order.indexOf(sectionId);
            
            // Special case for certificate
            if (sectionId === 'certificado' && !this.state.evaluation.passed) {
                return true;
            }
            
            // Check if previous sections are completed (for linear flow)
            // This is a simple check; can be made more robust
            if (targetIndex > 1 && !this.state.user) return true; // Must register
            if (targetIndex > 7 && !this.state.progress['evaluacion-formativa']) return true; // Must do formative eval
            
            return false;
        }

        updateProgress(sectionId) {
            this.state.progress[sectionId] = true;
            const completedCount = Object.keys(this.state.progress).length;
            const totalSections = this.sections.length;
            const percentage = (completedCount / totalSections) * 100;
            this.dom.progressBar.style.width = `${percentage}%`;
        }
        
        updateActiveNavLink(sectionId) {
            const links = this.dom.navMenu.querySelectorAll('a');
            links.forEach(link => {
                link.classList.remove('active-nav');
                if (link.getAttribute('href') === `#${sectionId}`) {
                    link.classList.add('active-nav');
                }
            });
        }
        
        updateUI() {
            if(this.state.evaluation.passed) {
                this.dom.nextFromEvalBtn.disabled = false;
            }
            this.prepareEvaluationScreen();
            this.renderCertificate();
        }

        // ---------- VIDEO QUIZ LOGIC ---------- //
        
        checkVideoTime() {
            // This is a simulated check as we can't truly get iframe video time without API
            // It relies on the user playing the video. A better implementation would use YouTube API.
            // For now, we rely on the timer.
            const player = document.getElementById('video-player');
            if(!player || document.getElementById('video-quiz-modal').style.display === 'flex') return;

            // This is a proxy for getting video time. We just run a timer.
            // We need a more reliable way. For now, let's keep the interval logic.
            // NOTE: This logic has been changed to a simple interval check due to iframe limitations.
            // The time check here is illustrative. The triggering will be done by a separate timer.
            // We can't actually do player.getCurrentTime() on a standard iframe.
        }

        // The timer-based approach to trigger the quiz
        triggerVideoQuiz(quizItem) {
            if (quizItem.answered) return;
            
            clearInterval(this.videoTimer); // Stop checking while quiz is open
            
            this.dom.videoQuizQuestion.textContent = quizItem.question;
            this.dom.videoQuizOptions.innerHTML = '';
            
            quizItem.options.forEach((opt, index) => {
                const label = document.createElement('label');
                label.className = 'quiz-option';
                label.innerHTML = `<input type="radio" name="video_quiz_opt" value="${index}" style="display:none;"> ${opt}`;
                label.onclick = () => {
                    document.querySelectorAll('#video-quiz-options .quiz-option').forEach(l => l.classList.remove('selected'));
                    label.classList.add('selected');
                }
                this.dom.videoQuizOptions.appendChild(label);
            });
            
            this.dom.videoQuizModal.dataset.correct = quizItem.correct;
            this.dom.videoQuizFeedback.style.display = 'none';
            this.dom.videoQuizModal.style.display = 'flex';
        }
        
        checkVideoQuizAnswer() {
            const selectedOption = this.dom.videoQuizOptions.querySelector('input[name="video_quiz_opt"]:checked');
            if (!selectedOption) {
                alert('Por favor, selecciona una respuesta.');
                return;
            }
            
            const selectedValue = parseInt(selectedOption.value);
            const correctValue = parseInt(this.dom.videoQuizModal.dataset.correct);
            const feedbackEl = this.dom.videoQuizFeedback;
            const selectedLabel = selectedOption.parentElement;
            
            if (selectedValue === correctValue) {
                feedbackEl.textContent = '¡Correcto! Puedes continuar con el video.';
                feedbackEl.style.color = 'var(--success-color)';
                selectedLabel.classList.add('correct');
                
                // Mark as answered and close modal after a delay
                const currentQuiz = this.videoQuizData.find(q => !q.answered);
                if(currentQuiz) currentQuiz.answered = true;

                setTimeout(() => {
                    this.dom.videoQuizModal.style.display = 'none';
                    selectedLabel.classList.remove('correct', 'selected');
                    // Resume video timer
                    this.videoTimer = setInterval(() => this.checkVideoTime(), 1000);
                }, 1500);

            } else {
                feedbackEl.textContent = 'Respuesta incorrecta. ¡Inténtalo de nuevo!';
                feedbackEl.style.color = 'var(--error-color)';
                selectedLabel.classList.add('incorrect');

                setTimeout(() => {
                    selectedLabel.classList.remove('incorrect', 'selected');
                    selectedOption.checked = false;
                }, 1500);
            }
            feedbackEl.style.display = 'block';
        }

        // A proxy timer to trigger quizzes at specific real-world times
        startVideoPlaybackTimer() {
            let playbackTime = 0;
            const videoPlaybackInterval = setInterval(() => {
                if(this.state.currentSection !== 'desarrollo-practico') {
                    clearInterval(videoPlaybackInterval);
                    return;
                }
                
                // If modal is open, pause our "playback" timer
                if(document.getElementById('video-quiz-modal').style.display === 'flex') {
                    return;
                }
                
                playbackTime++;

                const quizToTrigger = this.videoQuizData.find(q => q.time === playbackTime && !q.answered);
                if (quizToTrigger) {
                    this.triggerVideoQuiz(quizToTrigger);
                }

                if (playbackTime > 500) { // Stop timer after video ends
                    clearInterval(videoPlaybackInterval);
                }
            }, 1000);
        }
        
        // ---------- EVALUATION LOGIC ---------- //
        
        prepareEvaluationScreen() {
            this.dom.evaluationIntro.style.display = 'block';
            this.dom.evaluationQuiz.style.display = 'none';
            this.dom.evaluationResults.style.display = 'none';
            
            if (this.state.evaluation.attempts <= 0) {
                 this.dom.evaluationIntro.innerHTML = `
                    <div class="card">
                    <h3>No quedan más intentos</h3>
                    <p>Has utilizado todos tus intentos para la evaluación. Pero no te preocupes, ¡el aprendizaje es un viaje continuo! Puedes repasar los materiales y reiniciar el curso si lo deseas.</p>
                    </div>`;
            } else if (this.state.evaluation.passed) {
                this.dom.evaluationIntro.innerHTML = `
                    <div class="card">
                    <h3>¡Evaluación Aprobada!</h3>
                    <p>Felicidades, <span class="user-name">${this.state.user ? this.state.user.name.split(' ')[0] : 'profe'}</span>, has superado la evaluación con éxito. Ya puedes continuar a la síntesis y generar tu certificado.</p>
                    <button class="button" onclick="app.navigateTo('sintesis')">Continuar</button>
                    </div>`;
            }
        }
        
        startEvaluation() {
            if (this.state.evaluation.attempts <= 0) return;

            this.state.evaluation.attempts--;
            this.saveState();
            
            this.dom.evaluationIntro.style.display = 'none';
            this.dom.evaluationResults.style.display = 'none';
            this.dom.evaluationQuiz.style.display = 'block';

            this.renderEvaluationQuestions();
            this.startTimer();
        }

        renderEvaluationQuestions() {
            this.dom.evaluationContainer.innerHTML = '';
            // Shuffle questions for variety
            const shuffledQuestions = this.evaluationQuestions.sort(() => Math.random() - 0.5);
            shuffledQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'evaluation-question';
                questionDiv.innerHTML = `<h4>${index + 1}. ${q.question}</h4>`;
                
                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'quiz-options';

                // Shuffle options
                const shuffledOptions = q.options.map((opt, i) => ({ text: opt, originalIndex: i }))
                                                .sort(() => Math.random() - 0.5);

                shuffledOptions.forEach(opt => {
                    const label = document.createElement('label');
                    label.className = 'quiz-option';
                    // We store the original index to check for correctness
                    label.innerHTML = `<input type="radio" name="eval_q_${index}" value="${opt.originalIndex}" style="display:none;"> ${opt.text}`;
                    label.onclick = () => {
                        label.parentElement.querySelectorAll('.quiz-option').forEach(l => l.classList.remove('selected'));
                        label.classList.add('selected');
                    };
                    optionsDiv.appendChild(label);
                });
                questionDiv.appendChild(optionsDiv);
                this.dom.evaluationContainer.appendChild(questionDiv);
            });
        }

        startTimer() {
            this.state.evaluation.timer = 1800; // Reset timer
            this.state.evaluation.interval = setInterval(() => {
                this.state.evaluation.timer--;
                const minutes = Math.floor(this.state.evaluation.timer / 60);
                const seconds = this.state.evaluation.timer % 60;
                this.dom.evaluationTimer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (this.state.evaluation.timer <= 0) {
                    this.submitEvaluation();
                }
            }, 1000);
        }

        submitEvaluation() {
            clearInterval(this.state.evaluation.interval);
            let score = 0;
            const questions = this.dom.evaluationContainer.querySelectorAll('.evaluation-question');
            
            questions.forEach((q, index) => {
                const selected = q.querySelector('input:checked');
                const questionData = this.evaluationQuestions[index]; // Assuming order is preserved. A better way would be using data attributes.
                const allOptions = q.querySelectorAll('.quiz-option');
                
                allOptions.forEach(optLabel => {
                    const input = optLabel.querySelector('input');
                    if (parseInt(input.value) === questionData.correct) {
                        optLabel.classList.add('correct');
                    }
                });

                if (selected) {
                    const selectedLabel = selected.parentElement;
                    if (parseInt(selected.value) === questionData.correct) {
                        score++;
                    } else {
                        selectedLabel.classList.add('incorrect');
                    }
                }
            });

            const percentage = Math.round((score / this.evaluationQuestions.length) * 100);
            this.state.evaluation.score = percentage;
            this.dom.finalScore.textContent = percentage;
            this.dom.attemptsLeft.textContent = this.state.evaluation.attempts;

            if (percentage >= 70) {
                this.state.evaluation.passed = true;
                this.dom.finalStatus.textContent = "¡Aprobado!";
                this.dom.finalStatus.style.color = 'var(--success-color)';
                this.dom.resultsFeedback.innerHTML = `<p>¡Excelente trabajo, <span class="user-name">${this.state.user.name.split(' ')[0]}</span>! Has demostrado un gran entendimiento del tema.</p>`;
                this.dom.retryEvaluationBtn.style.display = 'none';
                this.dom.continueToSynthesisBtn.style.display = 'inline-block';
                this.dom.nextFromEvalBtn.disabled = false;
                this.checkAndAwardBadge('evaluacion');
            } else {
                this.dom.finalStatus.textContent = "Inténtalo de nuevo";
                this.dom.finalStatus.style.color = 'var(--error-color)';
                this.dom.resultsFeedback.innerHTML = `<p>No te preocupes. El aprendizaje es un proceso. Repasa los materiales e inténtalo de nuevo.</p>`;
                this.dom.continueToSynthesisBtn.style.display = 'none';
                if (this.state.evaluation.attempts > 0) {
                    this.dom.retryEvaluationBtn.style.display = 'inline-block';
                } else {
                    this.dom.retryEvaluationBtn.style.display = 'none';
                    this.dom.resultsFeedback.innerHTML += `<p>Has agotado tus intentos. Puedes reiniciar el curso para volver a intentarlo.</p>`;
                }
            }
            
            this.dom.evaluationQuiz.style.display = 'none';
            this.dom.evaluationResults.style.display = 'block';
            this.saveState();
        }
        
        // ---------- METACOGNITION & REPORT ---------- //
        saveMetacognition() {
            this.state.metacognition = {
                q1: document.getElementById('meta-q1').value,
                q2: document.getElementById('meta-q2').value,
                q3: document.getElementById('meta-q3').value
            };
            this.saveState();
            const feedback = document.getElementById('meta-saved-feedback');
            feedback.style.display = 'block';
            setTimeout(() => feedback.style.display = 'none', 3000);
        }

        // ---------- GAMIFICATION ---------- //
        checkAndAwardBadge(sectionId) {
            const badges = {
                'desarrollo-practico': { name: "Explorador Digital", desc: "Por completar el análisis práctico y el video-quiz.", icon: this.getBadgeSVG('explore') },
                'desarrollo-teorico': { name: "Arquitecto Conceptual", desc: "Por dominar los conceptos teóricos clave.", icon: this.getBadgeSVG('concept') },
                'evaluacion': { name: "Maestro Creador", desc: "¡Por superar la evaluación final con éxito!", icon: this.getBadgeSVG('master') }
            };

            const badgeKey = sectionId === 'evaluacion' && this.state.evaluation.passed ? sectionId : (sectionId !== 'evaluacion' ? sectionId : null);

            if (badgeKey && badges[badgeKey] && !this.state.badges.includes(badges[badgeKey].name)) {
                this.state.badges.push(badges[badgeKey].name);
                this.showBadgeModal(badges[badgeKey]);
                this.saveState();
            }
        }
        
        showBadgeModal(badge) {
            document.getElementById('badge-name').textContent = badge.name;
            document.getElementById('badge-description').textContent = badge.desc;
            document.getElementById('badge-icon').innerHTML = badge.icon;
            document.getElementById('badge-modal').style.display = 'flex';
        }

        getBadgeSVG(type) {
            const icons = {
                explore: '<path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L8 12v3l4-4-3-4h3l4.79 5.79c.19.23.19.58 0 .81L12 18v-3l-1.93 1.93c-.52.52-1.23.83-1.99.87z"/>',
                concept: '<path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/>',
                master: '<path fill="currentColor" d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/>'
            };
            return `<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="fill:var(--highlight-color);">${icons[type] || ''}</svg>`;
        }
        
        // ---------- CERTIFICATE LOGIC ---------- //
        renderCertificate() {
            if (!this.state.evaluation.passed) {
                this.dom.certificateContent.style.display = 'none';
                this.dom.certificateLocked.style.display = 'block';
                return;
            }
            
            this.dom.certificateContent.style.display = 'block';
            this.dom.certificateLocked.style.display = 'none';
            
            if (!this.state.user) return; // Can't generate without user data

            const today = new Date();
            const dateStr = today.toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' });

            const certificateHTML = `
                <div id="certificate-wrapper">
                    <div class="cert-header">
                        <p>Certificado de Finalización</p>
                        <h1>IA: Creatividad Aumentada o Amenazada</h1>
                    </div>
                    <div class="cert-body">
                        <p>Se certifica que</p>
                        <p id="cert-user-name">${this.state.user.name}</p>
                        <p>ha completado satisfactoriamente la cápsula educativa, demostrando competencias en el análisis crítico y la aplicación pedagógica de la Inteligencia Artificial en contextos creativos.</p>
                    </div>
                    <div class="cert-footer">
                        <div class="cert-signature">
                            <p><strong>Equipo de Desarrollo Web Creativo</strong></p>
                            <p>Instructor</p>
                        </div>
                        <div class="cert-details" style="text-align:center;">
                            <p><strong>Institución:</strong> Proyecto Educativo Independiente</p>
                            <p><strong>Horas Académicas:</strong> 2</p>
                             <p><strong>Emitido:</strong> ${dateStr}</p>
                        </div>
                        <div class="cert-qr">
                            <div id="cert-qrcode"></div>
                            <p><strong>ID de Verificación:</strong> ${new Date().getTime()}</p>
                        </div>
                    </div>
                </div>`;
            
            this.dom.certificatePlaceholder.innerHTML = certificateHTML;

            // Generate QR Code
            const qrContainer = document.getElementById('cert-qrcode');
            qrContainer.innerHTML = '';
            new QRCode(qrContainer, {
                text: window.location.href, // Or a specific verification URL
                width: 80,
                height: 80,
                colorDark : "#0d1b2a",
                colorLight : "#e0e1dd",
            });
        }
        
        downloadCertificate() {
            const element = document.getElementById('certificate-wrapper');
            if(!element) {
                alert("No se puede generar el certificado. Asegúrate de haber aprobado la evaluación.");
                return;
            }
            const opt = {
              margin:       0.5,
              filename:     `Certificado_IA_Creatividad_${this.state.user.name}.pdf`,
              image:        { type: 'jpeg', quality: 0.98 },
              html2canvas:  { scale: 2, useCORS: true },
              jsPDF:        { unit: 'in', format: 'letter', orientation: 'landscape' }
            };
            html2pdf().set(opt).from(element).save();
        }

    }

    const app = new EducationalCapsule();
    app.init();
    // This is a proxy for detecting when the user starts playing the video.
    document.getElementById('video-player').addEventListener('load', () => {
        let firstPlay = true;
        document.getElementById('video-container').addEventListener('click', () => {
             if (firstPlay) {
                app.startVideoPlaybackTimer();
                firstPlay = false;
             }
        }, { once: true });
    });

    </script>
</body>
</html>
